/*! Built with http://stenciljs.com */
VlocityTemplateEditor.loadBundle("slds-toast",["exports","./chunk-8aef71bd.js","./chunk-655d8ce7.js"],function(e,t,s){var i,a,o=window.VlocityTemplateEditor.h,n=function(){function e(){}return e.prototype.stateClassSelection=function(e){var t="slds-theme_info";switch(e){case"info":t="slds-theme_info";break;case"success":t="slds-theme_success";break;case"warning":t="slds-theme_warning";break;case"error":t="slds-theme_error"}return t},e.prototype.stateClassIconSelection=function(e){var t={title:"info",sprite:"utility",icon:"info"};switch(e){case"success":t={title:"success",sprite:"utility",icon:"success"};break;case"warning":t={title:"warning",sprite:"utility",icon:"warning"};break;case"error":t={title:"error",sprite:"utility",icon:"error"}}return t},e.prototype.positionClassSelection=function(e){var t="slds-text-align_right";switch(e){case"left":t="slds-text-align_left";break;case"center":t="slds-text-align_center";break;case"right":t="slds-text-align_right"}return t},e.prototype.removeToast=function(){var e=document.querySelector("slds-toast[toastid='"+this.toastid+"']");e.classList.add("fadeout"),setTimeout(function(){e.parentNode.removeChild(e)},500)},e.prototype.componentDidUnload=function(){},e.prototype.componentDidLoad=function(){var e=this;"true"!==this.sticky&&setTimeout(function(){e.removeToast()},e.timeout?e.timeout:4e3)},e.prototype.generateIcon=function(e,t,s,i){return'<svg aria-hidden="true" class="slds-button__icon slds-button__icon_large" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/apexpages/slds/latest/assets/icons/'+t+"-sprite/svg/symbols.svg#"+s+'"></use></svg><span class="slds-assistive-text">'+e+"</span>"},e.prototype.render=function(){var e=this,t=this.stateClassSelection(this.state),s=this.positionClassSelection(this.position),i=this.stateClassIconSelection(this.state);return o("div",{class:""+s},o("div",{class:"slds-notify slds-notify_toast "+t,role:"alert"},o("span",{class:"slds-assistive-text"},this.state),o("span",{class:"slds-icon_container slds-icon-utility-success slds-m-right_small slds-no-flex slds-align-top",title:this.description,innerHTML:this.generateIcon(i.title,i.sprite,i.icon)}),this.title&&""!==this.title?o("div",{class:"slds-notify__content"},o("h2",{class:"slds-text-heading_small "}," ",this.title," "),o("p",null,this.message)):o("div",{class:"slds-notify__content"},o("h2",{class:"slds-text-heading_small "},this.message)),o("button",{class:"slds-button slds-button_icon slds-notify__close slds-button_icon-inverse",title:"Close",onClick:function(){return e.removeToast()},innerHTML:this.generateIcon("close","utility","close",!0)})))},Object.defineProperty(e,"is",{get:function(){return"slds-toast"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{description:{type:String,attr:"description"},message:{type:String,attr:"message"},position:{type:String,attr:"position"},state:{type:String,attr:"state"},sticky:{type:String,attr:"sticky"},timeout:{type:String,attr:"timeout"},title:{type:String,attr:"title"},toastid:{type:String,attr:"toastid"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"\@keyframes fadein{0%{opacity:0}100%{opacity:1}}\@-webkit-keyframes fadein{0%{opacity:0}100%{opacity:1}}\@keyframes fadeout{0%{opacity:1}100%{opacity:0}}\@-webkit-keyframes fadeout{0%{opacity:1}100%{opacity:0}}slds-toast div{-webkit-animation:.5s ease 0s normal forwards 1 fadein;animation:.5s ease 0s normal forwards 1 fadein}slds-toast.fadeout div{-webkit-animation:.5s ease 0s normal forwards 1 fadeout;animation:.5s ease 0s normal forwards 1 fadeout}"},enumerable:!0,configurable:!0}),e}(),l=function(){function e(){this.nsPrefix=t.fileNsPrefix(),this.position=0}return e.prototype.show=function(){this.editorElement.classList.add("slds-show"),this.editorElement.classList.remove("slds-hide")},e.prototype.hide=function(){this.editorElement.classList.remove("slds-show"),this.editorElement.classList.add("slds-hide")},e.prototype.getText=function(){return this.editor.getValue()},e.prototype.isReadOnly=function(e){this.editor&&this.editor.updateOptions({readOnly:e})},e.prototype.updateSettings=function(e){"undefined"!=typeof monaco&&(monaco.editor.setTheme(e.theme),this.editor.updateOptions(e))},e.prototype.getModelMarkers=function(){return monaco.editor.getModelMarkers({})},e.prototype.getEditor=function(){return monaco.editor},e.prototype.getAllThemes=function(){var e=[];return this.editor._themeService._knownThemes.forEach(function(t){e.push(t.id)}),e},e.prototype.componentDidLoad=function(){var e=this,t=this;require(["vs/editor/editor.main"],function(){t.editor=monaco.editor.create(t.editorElement,{value:t.text,language:t.type,automaticLayout:!0,theme:e.configuration&&e.configuration[e.nsPrefix+"EditorTheme__c"]||null,fontSize:e.configuration&&e.configuration[e.nsPrefix+"FontSize__c"]||null}),t.editor.onDidChangeModelContent(function(){t.editor.hasTextFocus()&&t.editorContentChanged.emit()}),monaco.editor.onDidCreateEditor(function(){t.onEditorCreated.emit()})}),this.observer=new MutationObserver(function(){e.editor&&e.editor.layout()}),this.observer.observe(this.editorElement,{attributes:!0,attributeFilter:["class"],childList:!1,characterData:!1})},e.prototype.componentDidUnload=function(){this.observer.disconnect(),this.editor.dispose()},e.prototype.componentWillUpdate=function(){this.position=this.editor?this.editor.getPosition():null},e.prototype.componentDidUpdate=function(){this.editor&&(void 0===this.text&&this.editor.setValue(""),this.editor.setPosition(this.position))},e.prototype.render=function(){return""},Object.defineProperty(e,"is",{get:function(){return"vlocity-monaco-editor"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{configuration:{type:"Any",attr:"configuration"},editor:{state:!0},editorElement:{elementRef:!0},getAllThemes:{method:!0},getEditor:{method:!0},getModelMarkers:{method:!0},getText:{method:!0},hide:{method:!0},isReadOnly:{method:!0},observer:{state:!0},show:{method:!0},text:{type:String,attr:"text",mutable:!0},theme:{type:String,attr:"theme"},type:{type:String,attr:"type"},updateSettings:{method:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"textChanged",method:"textChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"editorContentChanged",method:"editorContentChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"onEditorCreated",method:"onEditorCreated",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return""},enumerable:!0,configurable:!0}),e}(),r=function e(s,i,a){var o=this;this.actionsList=s,this.config=a,this.remoteActionsList={},this.nsPrefix=t.fileNsPrefix(),this.invokeFunction=function(t){for(var s=[],i=1;i<arguments.length;i++)s[i-1]=arguments[i];var a=o.nsPrefix.replace("__","");return new Promise(function(i,o){var n={action:a+"."+e.className+"."+t,config:{escape:!1}},l=[];l.push(n.action);for(var r=0;r<s.length;r++)l.push(s[r]);l.push(function(e,t){!e&&!1===t.status&&(t.errors&&t.errors.length>0||"exception"===t.type)&&("exception"===t.type&&/STORAGE_LIMIT_EXCEEDED/.test(t.message)?alert(t.message+".\n You can increase your storage limit by contacting Salesforce or deleting unwanted data."):t.errors&&t.errors instanceof Array&&t.errors.forEach(function(e){"STORAGE_LIMIT_EXCEEDED"===e.status&&alert(e.message+".\n You can increase your storage limit by contacting Salesforce or deleting unwanted data.")})),t.statusCode<400?i(e):o(t)}),l.push(n.config);var d=Visualforce.remoting.Manager.invokeAction;console.log("invokeArgs ",l),d.apply(Visualforce.remoting.Manager,l)})},this.setupRemoteActions=function(){console.log("inside setup");for(var t=0,s=o.actionsList;t<s.length;t++){var i=s[t];o[i]=function(){console.log("test function");var t={action:o.nsPrefix.replace("__","")+"."+e.className+"."+i,config:{escape:!1}},s=[];s.push(t.action),s.push(function(e,t){console.log(e,t)}),s.push(t.config);var a=Visualforce.remoting.Manager.invokeAction;console.log("invokeArgs ",s),a.apply(Visualforce.remoting.Manager,s)}}console.log("actions are ",o.remoteActionsList)},e.className=i,console.log("yay remote actions from "+e.className+" "+s),this.setupRemoteActions()},d=function(){function e(){this.templateActions=new r(["getTemplates","getTemplate","getTemplateTypes","getTemplateByName","saveTemplate","getSassMixins","saveTemplateBypass","getCustomSettings","saveTemplateDesignerConfiguration","getTemplatesByIds"],"TemplateController",null)}return e.prototype.getTemplates=function(){return this.templateActions.invokeFunction("getTemplates")},e.prototype.getTemplate=function(e){return this.templateActions.invokeFunction("getTemplate",e)},e.prototype.getTemplateTypes=function(){},e.prototype.getTemplatesByIds=function(e){return this.templateActions.invokeFunction("getTemplatesByIds",e)},e.prototype.getTemplateByName=function(e){return this.templateActions.invokeFunction("getTemplateByName",e)},e.prototype.saveTemplate=function(e){return delete e.LastModifiedDate,this.templateActions.invokeFunction("saveTemplateBypass",e)},e.prototype.getSassMixins=function(){return this.templateActions.invokeFunction("getSassMixins")},e.prototype.isInsidePckg=function(){return this.templateActions.invokeFunction("isInsidePckg")},e.prototype.getCustomSettings=function(e){return this.templateActions.invokeFunction("getCustomSettings",e)},e.prototype.saveTemplateDesignerConfiguration=function(e){return this.templateActions.invokeFunction("saveTemplateDesignerConfiguration",e)},e}(),c="vlocity"===window.orgName.toLowerCase()?"vlocityDev":window.orgName;!function(e){e.save="mod+s",e.open="mod+o",e.help="mod+h",e.activate="mod+shift+a",e.preview="mod+shift+p",e.html="mod+1",e.scss="mod+2",e.javascript="mod+3",e.edit="mod+4"}(a||(a={}));var p=function(){function e(){this.isTemplateLocked=!1,this.modal=!1,this.templateTypes=[],this.template={},this.templates=[],this.currentEditor="html",this.isSavingTemplate=!1,this.isNewTemplate=!1,this.templateConfiguration={},this.diffTemplate={},this.isTemplateSaved=!0,this.templateSvc=new d,this.nsPrefix=t.fileNsPrefix(),this.sass=new Sass,this.mixins=[],this.saveTimeoutToken=null,this.templateJustLoaded=!0,this.diffMode=!1,this.isSaveEditBlock=!1,this.parentTemplate=void 0,this.isToggleActivation=!1,this.isInsidePackage=!1,this.sortingObj={isSorting:!1,field:"Name",reverse:!1},this.templateId=this.templateId||t.params.id,this.templateName=this.templateName||t.params.name,this.diffTemplateId=this.diffTemplateId||t.params.diffid,console.log("fileNsPrefix ",this.nsPrefix)}return e.prototype.loadTemplate=function(){var e=this,t=this;this.templateSvc.getTemplate(this.templateId).then(function(s){e.handleTemplateLoaded(s,t)}).catch(function(e){console.log("err ",e)}),window.addEventListener("beforeunload",function(e){if(!t.isTemplateSaved)return e.returnValue="Do you want to ignore changes you made?\nYour changes will be lost if you don't save them.","Do you want to ignore changes you made?\nYour changes will be lost if you don't save them."})},e.prototype.loadTemplateById=function(e,t){var s=this;this.templateSvc.getTemplate(e).then(function(e){t?(s.templateJustLoaded=!0,s.isTemplateSaved=!0,s.diffTemplate=Object.assign({},e),s.isTemplateLocked=s.isInsidePackage&&"vlocity"===s.diffTemplate[s.nsPrefix+"Author__c"].trim().toLowerCase(),s.toggleEditors()):s.template=Object.assign({},e),s.setTabTitle(s)}).catch(function(e){console.log("err ",e)})},e.prototype.loadTemplateByName=function(){var e=this,t=this;this.templateSvc.getTemplateByName(this.templateName).then(function(s){e.handleTemplateLoaded(s,t)}).catch(function(e){console.log("err ",e)})},e.prototype.getSassMixins=function(){var e=this,t=this;this.mixins.length<=0&&this.templateSvc.getSassMixins().then(function(s){e.mixins=s,e.mixins.forEach(function(e){t.sass.writeFile(e.Name,e[t.nsPrefix+"Sass__c"])})}).catch(function(e){console.log("err ",e)})},e.prototype.loadTemplateConfiguration=function(e){var t=this;this.templateSvc.getCustomSettings(e).then(function(e){(e="string"==typeof e?JSON.parse(e):e)[0]&&e[0][t.nsPrefix+"EditorTheme__c"]?(t.templateConfiguration=Object.assign({},e[0]),t.templateConfiguration[t.nsPrefix+"DefaultAuthor__c"]=t.templateConfiguration[t.nsPrefix+"DefaultAuthor__c"]||c):t.saveTemplateConfiguration()}).catch(function(e){console.log("err ",e)})},e.prototype.saveTemplateConfiguration=function(){var e=this,t=this;this.templateSvc.saveTemplateDesignerConfiguration(this.getEditorCustomSettings()).then(function(s){e.templateConfiguration=Object.assign({},s);for(var i=e.modalElement.querySelectorAll("vlocity-monaco-editor"),a=0;a<i.length;a++){var o=i[a],n={};n.theme=e.templateConfiguration[e.nsPrefix+"EditorTheme__c"],n.fontSize=e.templateConfiguration[e.nsPrefix+"FontSize__c"],n.wordWrap=e.templateConfiguration[e.nsPrefix+"WordWrap__c"]?"on":"off",o.updateSettings(n)}e.templateConfiguration[e.nsPrefix+"DefaultAuthor__c"]=e.templateConfiguration[e.nsPrefix+"DefaultAuthor__c"]||c;var l=document.querySelector("#settingsModal");l&&(l.parentNode.removeChild(l),t.showToast("success","Settings saved!",""))}).catch(function(e){t.showToast("error","Error Saving","Template designer configuration","0",!0),console.log("err ",e)})},e.prototype.getEditorCustomSettings=function(){var e=document.querySelector("#editorTheme"),t=document.querySelector("#fontSize"),s=document.querySelector("#defaultAuthor"),i=document.querySelector("#autoSave"),a=document.querySelector("#wordWrap"),o={};return o[this.nsPrefix+"EditorTheme__c"]=e?e.value:this.templateConfiguration[this.nsPrefix+"EditorTheme__c"]||"vs-dark",o[this.nsPrefix+"FontSize__c"]=t?t.value:this.templateConfiguration[this.nsPrefix+"FontSize__c"]||"15",o[this.nsPrefix+"DefaultAuthor__c"]=s?s.value:this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||s,o[this.nsPrefix+"AutoSave__c"]=i?i.checked:this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||!1,o[this.nsPrefix+"WordWrap__c"]=a?a.checked:this.templateConfiguration[this.nsPrefix+"WordWrap__c"]||!1,o},e.prototype.setTabTitle=function(e){var t;document.querySelector("#sldsToast").innerHTML="",document.title=this.isDiffTemplate()?"Template Diff":this.template&&this.template.Name||"Loading...",sforce.console&&sforce.console.isInConsole()&&(this.isNewTemplate?(sforce.console.getEnclosingTabId(function(e){t=e.id,setTimeout(function(){sforce.console.closeTab(e.id)},0)}),sforce.console.getEnclosingPrimaryTabId(function(s){t===s.id?sforce.console.openPrimaryTab(null,i,!1,e.template.Name,null,null,null):sforce.console.openSubtab(s.id,i,!1,e.template.Name,null,null,null)})):sforce.console.getEnclosingTabId(function(t){var s=t.id;sforce.console.setTabTitle(e.template.Name,s)}))},e.prototype.handleTemplateLoaded=function(e,t){this.template=Object.assign({},e),this.setTabTitle(this),this.templateId=this.template.Id,console.log("template ",this.template),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors(),this.templateLoaded.emit(t.template)},e.prototype.enableShortCuts=function(){var e=new s.ShortcutKeys;e.bindGlobal(a.save,function(){this.diffMode?this.saveTemplateMain():this.saveTemplate()},this),e.bindGlobal(a.open,function(){!this.diffMode&&this.open()},this),e.bindGlobal(a.help,this.help,this),e.bindGlobal(a.activate,function(){!this.diffMode&&this.toggleShortcutActivation()},this),e.bindGlobal(a.preview,function(){!this.diffMode&&this.tabKeyChange("preview")},this),e.bindGlobal(a.html,function(){this.tabKeyChange("html")},this),e.bindGlobal(a.scss,function(){this.tabKeyChange("scss")},this),e.bindGlobal(a.javascript,function(){this.tabKeyChange("javascript")},this),e.bindGlobal(a.edit,function(){!this.diffMode&&this.tabKeyChange("edit")},this)},e.prototype.sortAlphabetically=function(){var e=this.templates.slice();e.sort(function(e,t){return e.Name.localeCompare(t.Name)}),this.templates=e.slice()},e.prototype.loadAllTemplates=function(){var e=this,t=this;this.templates.length<=0&&this.templateSvc.getTemplates().then(function(s){e.templates=s,e.templates.forEach(function(e){-1===t.templateTypes.indexOf(e[t.nsPrefix+"Type__c"])&&t.templateTypes.push(e[t.nsPrefix+"Type__c"])}),e.templateId||e.open(),console.log("template ",e.templates),e.sortAlphabetically()}).catch(function(e){console.log("err ",e)})},e.prototype.tabKeyChange=function(e){this.currentEditor=e,this.toggleEditors()},e.prototype.handleRadioChange=function(e){var t=e.target;!0===t.checked&&(this.currentEditor=t.id,this.toggleEditors())},e.prototype.toggleShortcutActivation=function(){var e,t=document.getElementById("templateActive");t.checked=!t.checked,this.template=Object.assign({},this.template,((e={})[this.nsPrefix+"Active__c"]=t.checked,e)),this.isToggleActivation=!0,this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||this.saveTemplate(),console.log("template ",this.template)},e.prototype.toggleActivation=function(e){var t,s=e.target;this.template=Object.assign({},this.template,((t={})[this.nsPrefix+"Active__c"]=s.checked,t)),this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||this.saveTemplate(e),this.isToggleActivation=!0,console.log("template ",this.template)},e.prototype.openPreview=function(e){var t=e.target;this.currentEditor=t.id,this.toggleEditors()},e.prototype.toggleEditors=function(){console.log(this.template);for(var e=this.modalElement.querySelectorAll("vlocity-monaco-editor, vlocity-template-info, vlocity-template-preview, vlocity-template-diff"),t=0;t<e.length;t++){var s=e[t];s.getAttribute("type")===this.currentEditor?(s.show(),this.isTemplateLocked&&s.isReadOnly?s.isReadOnly(!0):s.isReadOnly&&s.isReadOnly(!1)):s.hide()}},e.prototype.showToast=function(e,t,s,i,a){var o=document.createElement("slds-toast");o.setAttribute("state",e),o.setAttribute("title",s||""),o.setAttribute("message",t),o.setAttribute("toastid","toast"+Date.now()),o.setAttribute("timeout",i||"4000"),o.setAttribute("sticky",a+"");var n=document.getElementById("sldsToast");n.insertBefore(o,n.firstChild)},e.prototype.showModal=function(){var e=document.createElement("slds-modal");e.setAttribute("modalid","modal-123"),e.setAttribute("title","My Title"),e.innerHTML='<pre slot="modal-content">test</pre>',document.getElementById("template-designer").appendChild(e)},e.prototype.syncEditorChanges=function(e){var t,s,i;if(this.templateJustLoaded)return e;for(var a=this.modalElement.querySelectorAll("vlocity-monaco-editor"),o=0;o<a.length;o++){var n=a[o];switch(n.getAttribute("type")){case"html":e=Object.assign({},e,((t={})[this.nsPrefix+"HTML__c"]=n.getText(),t));break;case"javascript":e=Object.assign({},e,((s={})[this.nsPrefix+"CustomJavascript__c"]=n.getText(),s));break;case"scss":e=Object.assign({},e,((i={})[this.nsPrefix+"Sass__c"]=n.getText(),i))}}return e},e.prototype.getAllMarkers=function(){var e=this.modalElement.querySelectorAll("vlocity-monaco-editor");if(e&&e.length>0)return e[0].getModelMarkers()},e.prototype.saveTemplate=function(e,t,s){if(!this.isSavingTemplate){this.isSavingTemplate=!0;var i=this,a=t||this.syncEditorChanges(this.template),o=t?s:this.getAllMarkers();(o=(o=o||[]).filter(function(e){return 3===e.severity})).length>0&&(console.log(o),i.isSavingTemplate=!1,o.forEach(function(e){i.showToast("error",e.message+" line: "+e.startLineNumber,e.owner&&e.owner.toUpperCase(),"0",!0)})),this.sass.compile(a[this.nsPrefix+"Sass__c"]||"",function(e){var t;if(i.templateJustLoaded=!i.isSaveEditBlock,1===e.status)return console.log("error ",e),o.find(function(t){return e.line===t.startLineNumber&&e.column===t.startColumn})||i.showToast("error",e.message+" line : "+e.line,"CSS","0",!0),void(i.isSavingTemplate=!1);if(!e.status||3===e.status){if(o&&o.length>0)return;console.log("compiled Sass ",e),a=Object.assign({},a,((t={})[i.nsPrefix+"CSS__c"]=e.text?e.text:"",t)),i.templateSvc.saveTemplate(a).then(function(e){i.isSavingTemplate=!1,i.isTemplateSaved=!0,i.isToggleActivation?(i.showToast(a[i.nsPrefix+"Active__c"]?"success":"info",a[i.nsPrefix+"Active__c"]?"Template Activated":"Template Deactivated",a.Name+" (V"+a[i.nsPrefix+"Version__c"]+")","2000"),i.isToggleActivation=!1):i.showToast("success","Saved Successfully!",a.Name+" (V"+a[i.nsPrefix+"Version__c"]+")","2000"),i.templates.filter(function(t){return t.Name===e.Name}).forEach(function(t){e[i.nsPrefix+"Active__c"]&&(t[i.nsPrefix+"Active__c"]=!1),t[i.nsPrefix+"Author__c"]===e[i.nsPrefix+"Author__c"]&&t[i.nsPrefix+"Version__c"]===e[i.nsPrefix+"Version__c"]&&(t[i.nsPrefix+"Active__c"]=e[i.nsPrefix+"Active__c"],t.LastModifiedDate=e.LastModifiedDate)}),console.log("saved ",e)}).catch(function(e){i.isSavingTemplate=!1,i.showToast("error","Error Saving",a.Name,"0",!0),console.log("err ",e)})}}),console.log("template ",this.template,e)}},e.prototype.createVersion=function(){var e=this,t=Object.assign({},this.template),s=1,i=this;delete(t=this.syncEditorChanges(t)).Id,delete t[this.nsPrefix+"ExternalID__c"],this.templates.filter(function(e){return e.Name===t.Name&&e[i.nsPrefix+"Author__c"]===t[i.nsPrefix+"Author__c"]}).forEach(function(e){s=e[i.nsPrefix+"Version__c"]>s?e[i.nsPrefix+"Version__c"]:s}),t[this.nsPrefix+"Version__c"]=s+1,t[this.nsPrefix+"Active__c"]=!1,t[this.nsPrefix+"Definition__c"]=this.template[this.nsPrefix+"Definition__c"],this.isSavingTemplate=!0;var a=this;this.templateSvc.saveTemplate(t).then(function(t){e.isSavingTemplate=!1,e.isNewTemplate=!e.templateId,i.template=Object.assign({},t),i.showToast("success","Version created Successfully"),i.templates.push(i.template),e.templateLoaded.emit(i.template),e.isTemplateLocked=e.isInsidePackage&&"vlocity"===e.template[e.nsPrefix+"Author__c"].trim().toLowerCase(),e.toggleEditors(),console.log("saved ",t)}).catch(function(e){a.isSavingTemplate=!1,i.showToast("error","Error Saving","","0",!0),console.log("err ",e)})},e.prototype.open=function(e){var s,i=this,a=document.createElement("slds-modal");a.setAttribute("Id","openModal"),a.setAttribute("title","Template Manager"),a.setAttribute("size","medium"),a.setAttribute("enable-close",this.templateId?"true":"false"),this.sortingObj.isSorting=!1,s='<div slot="modal-content">\n                        <div class="slds-tabs_default">\n                        <ul class="slds-tabs_default__nav  custom-tab" id="tabSelect" role="tablist">\n                        <li class="slds-tabs_default__item '+(this.templateId?"slds-is-active":"")+'" title="Item One" role="presentation"><a data-tabId="tab1" class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-default-1" id="tab-default-1__item">Select Template</a></li>\n                        <li class="slds-tabs_default__item '+(this.templateId?"":"slds-is-active ")+(this.diffMode?"slds-hide":"")+'" title="Item Two" role="presentation"><a data-tabId="tab2" class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-default-2" id="tab-default-2__item">Create Template</a></li>\n                        </ul>\n                        <div id="tab1" class="slds-tabs_default__content tab-content '+(this.templateId?"slds-show":"slds-hide")+' role="tabpanel" aria-labelledby="tab-default-1__item">\n                        <div class="slds-p-top_small slds-p-horizontal_x-large template-search-box">\n                        <input id="searchTemplate"  class="slds-input" placeholder="Enter Name" type="text" /></div>\n                        <div class="slds-grid slds-wrap slds-grid--vertical-stretch template-list"  id="templateList">\n                        '+this.generateTemplate(this.templates)+'\n                        </div></div>\n                        </div>\n                        <div id="tab2" class="slds-tabs_default__content tab-content '+(this.templateId?"slds-hide":"slds-show")+' role="tabpanel" aria-labelledby="tab-default-2__item">\n                        <div class="new-template-content">\n                        <div id="modalInnerError" class="slds-text-color--error slds-p-vertical_x-small"></div>\n                        '+(this.createInputElem("newTemplateName","Template Name","Enter Name","","",!0)+this.createInputElem("newTemplateAuthor","Template Author","Enter Author",this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"],"",!0)+this.createComboBoxElem("newTemplateType","Template Type","Enter Template Type",this.templateTypes,"",!0))+"\n                        </div>\n                        </div></div>\n                        "+(this.templateId?'<button slot="modal-footer" id="btnCreate" class="slds-button slds-button_brand '+(this.templateId?"slds-hide":"")+'">Create</button>':'<div class="slds-float_right" slot="modal-footer"><button  id="btnCreate" class="slds-button slds-button_brand '+(this.templateId?"slds-hide":"")+'">Create</button>\n                        <a href="/apex/'+this.nsPrefix+'TemplateHome" class="slds-button slds-button_neutral " >Go Home</a>\n                        </div>'),a.innerHTML=s,document.getElementById("template-designer").appendChild(a),document.getElementById("searchTemplate").addEventListener("keyup",function(){var e=this,t=i.templates.filter(function(t){return t.Name.toLowerCase().includes(e.value.toLowerCase())});document.getElementById("templateList").innerHTML=i.generateTemplate(t)}),document.getElementById("templateList").addEventListener("click",function(s){var a=s.target;if(a.getAttribute("data-templateid")&&i.changeTemplate(a.getAttribute("data-templateid"),e),a.getAttribute("template-href")&&t.vlocityOpenUrl(a.getAttribute("template-href"),s,!0),a.getAttribute("diff-templateid")){i.parentTemplate=i.parentTemplate?i.parentTemplate:i.template,i.updateUrl("diffid",a.getAttribute("diff-templateid")),i.diffTemplate=void 0,i.diffTemplateId=a.getAttribute("diff-templateid"),i.initLoad();var o=document.querySelector("#openModal");o.parentNode.removeChild(o)}if(a.getAttribute("data-sort-field")){var n=a.getAttribute("data-sort-field"),l=!1;a.querySelector("svg").classList.contains("slds-transition-show")&&a.querySelector("svg use").href.baseVal.includes("arrowup")&&(l=!0),i.sortingObj.reverse=l,i.sortTemplates(n,l)}}),document.getElementById("tabSelect").addEventListener("click",function(e){var t=e.target,s="";t.getAttribute("data-tabId")&&(s=this.getElementsByTagName("li"),[].forEach.call(s,function(e){e.classList.remove("slds-is-active")}),t.parentNode.classList.add("slds-is-active"),s=document.getElementsByClassName("tab-content"),[].forEach.call(s,function(e){e.classList.remove("slds-show"),e.classList.add("slds-hide")}),document.getElementById(t.getAttribute("data-tabId")).classList.remove("slds-hide"),document.getElementById(t.getAttribute("data-tabId")).classList.add("slds-show"),document.getElementById("btnCreate").classList.toggle("slds-hide"))}),document.getElementById("btnCreate").addEventListener("click",function(){i.create()})},e.prototype.sortTemplates=function(e,t){var s=document.getElementById("searchTemplate");this.sortingObj={isSorting:!0,field:e||"Name",reverse:t};var i=JSON.parse(JSON.stringify(this.templates));i=(i=i.sort(this.dynamicSort(this.sortingObj.field,t))).filter(function(e){return e.Name.toLowerCase().includes(s.value.toLowerCase())}),document.getElementById("templateList").innerHTML=this.generateTemplate(i)},e.prototype.dynamicSort=function(e,t,s){var i=s?function(t){return s(t[e])}:function(t){return"number"==typeof t[e]?t[e]:t[e].toLowerCase()};return t=t?-1:1,function(e,s){return e=i(e),s=i(s),t*((e>s?1:-1)-(s>e?1:-1))}},e.prototype.modalRenderedHandler=function(){var e=this,t=document.querySelector("#searchTemplate"),s=document.querySelector("#btnClone");t?window.setTimeout(function(){document.getElementById("searchTemplate").focus()},0):s&&window.setTimeout(function(){s.addEventListener("click",function(){e.handleClone()})},0)},e.prototype.updateQueryStringParameter=function(e,t,s){var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+s+"$2"):e+a+t+"="+s},e.prototype.updateUrl=function(e,t){var s=this.nsPrefix+"uitemplatedesigner",a=location.href;a.includes(s)||(a=a.replace("uitemplatedesigner",s));var o=this.updateQueryStringParameter(a,e,t);i=o,window.history.pushState({path:o},"",o)},e.prototype.removeUrlParam=function(e){var t=document.location.href,s=t.split("?");if(s.length>=2){for(var i=s.shift(),a=s.join("?"),o=encodeURIComponent(e)+"=",n=a.split(/[&;]/g),l=n.length;l-- >0;)-1!==n[l].lastIndexOf(o,0)&&n.splice(l,1);t=i+"?"+n.join("&"),window.history.pushState("",document.title,t)}},e.prototype.generateTemplate=function(e){var t=this,s=!1,i=function(e){return'<svg aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon '+(t.sortingObj.isSorting&&e===t.sortingObj.field?"slds-transition-show":"slds-transition-hide")+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#'+(t.sortingObj.reverse?"arrowdown":"arrowup")+'"></use></svg>'};this.templateId||(s=!0);for(var a='<div class="slds-table--header-fixed_container fixedHeaderContainer"><div class="slds-scrollable_y fixedHeader"><table class="slds-table slds-table_bordered slds-table_striped slds-table--header-fixed"><thead><tr class="slds-text-title_caps"><th scope="col"><div class="slds-truncate slds-cell-fixed marginLeft10" title="Name" data-sort-field="Name"> Name '+i("Name")+'</div></th><th scope="col"><div class="slds-truncate slds-cell-fixed" title="Author" data-sort-field="'+this.nsPrefix+'Author__c"> Author '+i(this.nsPrefix+"Author__c")+'</div></th><th scope="col"><div class="slds-truncate slds-cell-fixed" title="Version">Version </div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed marginLeft60" title="Last Modified Date" data-sort-field="LastModifiedDate">Last Modified Date '+i("LastModifiedDate")+'</div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed" title="Active">Active </div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed marginLeft31" title="Action">Action </div></th></tr></thead><tbody>',o="",n="",l=0;l<e.length;l++)this.template.Id!==e[l].Id&&(n="/apex/"+this.nsPrefix+"uitemplatedesigner?id="+e[l].Id,o=e[l][this.nsPrefix+"Active__c"]?"":" slds-hide ",a+='<tr><th scope="row" data-label="Name"><div class="slds-truncate custom-table-cell-width" title="Open"><a alt="Open" href="javascript:void(0)" data-templateId="'+e[l].Id+'">'+e[l].Name+'</a></div></th><td data-label="Author"><div class="slds-truncate" title="Author">'+e[l][this.nsPrefix+"Author__c"]+'</div></td><td data-label="Version"><div class="slds-truncate  slds-text-align_center" title="Version">'+e[l][this.nsPrefix+"Version__c"]+'</div></td><td data-label="Version"><div class="slds-truncate  slds-text-align_center" title="Last Modified Date">'+this.getFormattedDateTime(e[l].LastModifiedDate)+'</div></td><td data-label="Active"><div class="slds-truncate  slds-text-align_center   custom-icon-height" title="Active"><span class="'+o+'"><svg aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#success"></use></svg><span class="slds-assistive-text">Active</span></span></div></td><td data-label="Action" class="action-holder"><div class="slds-truncate  slds-text-align_center" title="Open in new tab"><a alt="Open in new tab" template-href="'+n+'" title="Open in new tab" target="_blank" class="slds-p-around_x-small vloc-modal-container-first"><span class=""><svg aria-hidden="true" template-href="'+n+'" class="slds-icon slds-icon--x-small new-tab-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use template-href="'+n+'" xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#new_window"></use></svg><span class="slds-assistive-text">Open</span></span><div class="slds-popover slds-popover_tooltip slds-nubbin_top-right vloc-modal-popover" role="tooltip" id="help" style="position: absolute;"><div class="slds-popover__body">Open in new tab</div></div></a><a alt="Diff" href="javascript:void(0)" diff-templateId="'+e[l].Id+'" class="slds-p-around_x-small vloc-modal-container-second '+(this.diffMode?"slds-hide":"")+(s?" disabled-icon":"")+'" title="Diff" ><svg diff-templateId="'+e[l].Id+'" aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use class="pointer-none" diff-templateId="'+e[l].Id+'" xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#knowledge_base"></use></svg><span class="slds-assistive-text">Diff</span><div class="slds-popover slds-popover_tooltip slds-nubbin_top-right vloc-modal-popover" role="tooltip" id="help" style="position: absolute;"><div class="slds-popover__body">Template Diff</div></div></a></div></td></tr>');return a+"</tbody></table></div></div>"},e.prototype.getFormattedDateTime=function(e){var t=new Date(e);return t.toLocaleString().split(",")[0]+" "+t.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})},e.prototype.changeTemplate=function(e,t,s){var i=!0;if(this.isTemplateSaved||this.isDiffTemplate()&&!t&&!s||(i=this.openModal("Do you want to ignore changes you made?\nYour changes will be lost if you don't save them.")),i){this.removeUrlParam("diffid"),this.currentEditor="html",this.diffMode&&!s?(t?(this.diffTemplate=void 0,this.diffTemplateId=e):(this.template=void 0,this.templateId=e),this.loadTemplateById(e,t)):s?(this.template=t?Object.assign({},this.diffTemplate):Object.assign({},this.template),this.templateId=e,this.diffTemplate=void 0,this.diffTemplateId=void 0,this.templateJustLoaded=!0,this.isTemplateSaved=!0,this.setTabTitle(this),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.template.Id!==e&&(this.template=this.parentTemplate,this.parentTemplate=void 0,this.loadTemplate())):(this.diffTemplate=void 0,this.template=void 0,this.diffTemplateId=void 0,this.templateId=e,this.loadTemplate()),this.updateUrl(t&&!s?"diffid":"id",e);var a=document.querySelector("#openModal");a&&a.parentNode.removeChild(a)}},e.prototype.openModal=function(e){return window.confirm(e)},e.prototype.clone=function(){var e="",t=document.createElement("slds-modal");t.setAttribute("Id","cloneModal"),t.setAttribute("title","Clone Template"),e+='<div slot="modal-content" class="slds-p-top_small">'+this.createInputElem("cloneTemplateName","Template Name","Enter Name",this.template.Name)+this.createInputElem("cloneAuthor","Author","Enter Author",this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||this.template[this.nsPrefix+"Author__c"])+this.createComboBoxElem("cloneType","Template Type","Enter Template Type",this.templateTypes,this.template[this.nsPrefix+"Type__c"])+'</div><button slot="modal-footer" id="btnClone" class="slds-button slds-button_brand">Clone</button>',t.innerHTML=e,document.getElementById("template-designer").appendChild(t)},e.prototype.help=function(){var e="",t=document.createElement("slds-modal");t.setAttribute("Id","helpModal"),t.setAttribute("title","Help"),e+='<div slot="modal-content"><help-modal></help-modal></div>',t.innerHTML=e,document.getElementById("template-designer").appendChild(t)},e.prototype.openSettings=function(){var e=this,t="",s=this.getEditorCustomSettings(),i=this.modalElement.querySelectorAll("vlocity-monaco-editor"),a=i&&i.length>0?i[0].getAllThemes():[],o=document.createElement("slds-modal");o.setAttribute("Id","settingsModal"),o.setAttribute("title","Settings"),t+='<div slot="modal-content"><div id="modalInnerError" class="slds-text-color--error slds-p-vertical_x-small"></div>'+this.createSelectElem("editorTheme","Editor Theme",a,s[this.nsPrefix+"EditorTheme__c"])+this.createInputElem("fontSize","Font Size","Enter Font Size",""+s[this.nsPrefix+"FontSize__c"],"number")+this.createInputElem("defaultAuthor","Default Author","Enter Default Author",""+s[this.nsPrefix+"DefaultAuthor__c"])+this.createCheckboxElem("autoSave","Auto Save",s[this.nsPrefix+"AutoSave__c"])+this.createCheckboxElem("wordWrap","Wordwrap",s[this.nsPrefix+"WordWrap__c"])+'</div><button slot="modal-footer" id="saveSettings" class="slds-button slds-button_brand">Save</button>',o.innerHTML=t,document.getElementById("template-designer").appendChild(o),document.getElementById("saveSettings").addEventListener("click",function(){e.saveTemplateConfiguration()})},e.prototype.create=function(){var e=this,t=document.querySelector("#newTemplateName"),s=document.querySelector("#newTemplateAuthor"),i=document.querySelector("#newTemplateType"),a=document.querySelector("#modalInnerError"),o=this;if(t.value)if(s.value)if(i.value)if(n=t.value,l=s.value,o.templates.find(function(e){return e.Name.toLowerCase()===n.toLowerCase()&&e[o.nsPrefix+"Author__c"].toLowerCase()===l.toLowerCase()}))a.innerHTML="A template with same name and author already exists, try creating a new version.";else if(function(e){return!o.isInsidePackage||"vlocity"!==e.trim().toLowerCase()}(s.value)){var n,l,r={};r.Name=t.value,r[this.nsPrefix+"Type__c"]=i.value,r[this.nsPrefix+"Author__c"]=s.value,r[this.nsPrefix+"Version__c"]=1,r[this.nsPrefix+"Active__c"]=!1,this.templateSvc.saveTemplate(r).then(function(t){o.template=Object.assign({},t),o.showToast("success","Created Successfully"),o.templates.push(o.template),e.isNewTemplate=!e.templateId,e.templateLoaded.emit(o.template),e.updateUrl("id",o.template.Id),e.templateId=o.template.Id,e.isTemplateLocked=e.isInsidePackage&&"vlocity"===e.template[e.nsPrefix+"Author__c"].trim().toLowerCase(),e.toggleEditors(),e.setTabTitle(o);var s=document.querySelector("#openModal");s.parentNode.removeChild(s)}).catch(function(e){o.showToast("error","Error creating template","","0",!0),console.log("err ",e)})}else a.innerHTML="Creating 'Vlocity' authored template is not allowed.";else a.innerHTML="You must specify template type.";else a.innerHTML="You must specify template author.";else a.innerHTML="You must specify template name."},e.prototype.createInputElem=function(e,t,s,i,a,o){return i=i||"",'<slds-input label="'+t+'" type="'+(a=a||"text")+'" placeholder="'+s+'" inputid="'+e+'" value="'+i+'" required='+(o=o||!1)+">  </slds-input>"},e.prototype.createSelectElem=function(e,t,s,i){return'<slds-select label="'+t+'" selectid="'+e+'" value="'+i+'" options="'+s+'"></slds-select>'},e.prototype.createCheckboxElem=function(e,t,s){return'<slds-checkbox label="'+t+'" checkboxid="'+e+'" value='+s+"></slds-checkbox>"},e.prototype.createComboBoxElem=function(e,t,s,i,a,o){return'<slds-combobox label="'+t+'" comboid="'+e+'" options="'+i+'" value="'+a+'" placeholder="'+s+'" required='+o+"></slds-combobox>"},e.prototype.handleClone=function(){var e=this,t=document.querySelector("#cloneTemplateName"),s=document.querySelector("#cloneAuthor"),i=document.querySelector("#cloneType"),a=document.querySelector("#modalError"),o=this;if(t.value)if(s.value)if(i.value)if(n=t.value,l=s.value,o.templates.find(function(e){return e.Name.toLowerCase()===n.toLowerCase()&&e[o.nsPrefix+"Author__c"].toLowerCase()===l.toLowerCase()}))a.innerHTML="A template with same name and author already exists, try creating a new version.";else if(function(e){return!o.isInsidePackage||"vlocity"!==e.trim().toLowerCase()}(s.value)){var n,l,r=Object.assign({},this.template);delete(r=this.syncEditorChanges(r)).Id,delete r[this.nsPrefix+"ExternalID__c"],r.Name=t.value,r[this.nsPrefix+"Type__c"]=i.value,r[this.nsPrefix+"Author__c"]=s.value,r[this.nsPrefix+"Version__c"]=1,r[this.nsPrefix+"Active__c"]=!1,r[this.nsPrefix+"ParentID__c"]=this.template[this.nsPrefix+"ExternalID__c"],r[this.nsPrefix+"Definition__c"]=this.template[this.nsPrefix+"Definition__c"],this.templateSvc.saveTemplate(r).then(function(t){o.template=Object.assign({},t),o.showToast("success","Cloned Successfully"),o.templates.push(o.template),e.templateLoaded.emit(o.template),e.isTemplateLocked=e.isInsidePackage&&"vlocity"===e.template[e.nsPrefix+"Author__c"].trim().toLowerCase(),e.toggleEditors(),e.setTabTitle(e);var s=document.querySelector("#cloneModal");s.parentNode.removeChild(s)}).catch(function(e){o.showToast("error","Error creating clone","","0",!0),console.log("err ",e)})}else a.innerHTML="Creating 'Vlocity' authored template is not allowed.";else a.innerHTML="You must specify template type.";else a.innerHTML="You must specify template author.";else a.innerHTML="You must specify template name."},e.prototype.isDiffTemplate=function(){return!(!this.diffTemplateId||!this.diffTemplate)},e.prototype.getDiffTemplates=function(){var e=this,t=this;this.templateSvc.getTemplatesByIds([this.templateId,this.diffTemplateId]).then(function(s){e.templateId==e.diffTemplateId?(e.diffTemplate=Object.assign({},s[0]),e.template=Object.assign({},s[0])):e.templateId===s[1].Id?(e.diffTemplate=Object.assign({},s[0]),e.template=Object.assign({},s[1])):(e.diffTemplate=Object.assign({},s[1]),e.template=Object.assign({},s[0])),e.templateJustLoaded=!0,e.isTemplateSaved=!0,e.setTabTitle(e),e.isTemplateLocked=e.isInsidePackage&&"vlocity"===e.diffTemplate[e.nsPrefix+"Author__c"].trim().toLowerCase(),window.setTimeout(function(){t.toggleEditors()},0)}).catch(function(e){console.log("err ",e)})},e.prototype.onTemplateLoaded=function(e){this.templateJustLoaded=!0,this.isTemplateSaved=!0;var t=e.detail,s=window.location.href.split(/[?&]/).find(function(e){return/^id\=/.test(e)});if(s&&(s=s.replace(/^id=/,"")),!s||s!==t.Id)if(s){var i=window.location.href.replace(s,t.Id);window.history.pushState("","",i)}else{var a=window.location.pathname+(0===window.location.search.length?"?":window.location.search+"&")+"id="+t.Id;window.history.pushState("","",a)}},e.prototype.changeInTemplateInfoHandler=function(e){var t,s=e.detail;this.template=Object.assign({},this.template,((t={}).Name=s.Name,t[this.nsPrefix+"Description__c"]=s[this.nsPrefix+"Description__c"],t[this.nsPrefix+"Author__c"]=s[this.nsPrefix+"Author__c"],t[this.nsPrefix+"Definition__c"]=s[this.nsPrefix+"Definition__c"],t[this.nsPrefix+"SampleJson__c"]=s[this.nsPrefix+"SampleJson__c"],t)),this.templateChangeHandler(!0)},e.prototype.templateChangeHandler=function(e){this.isSaveEditBlock=e||!1,this.template=this.syncEditorChanges(this.template);var t=this;this.templateConfiguration[this.nsPrefix+"AutoSave__c"]?(this.saveTimeoutToken&&clearTimeout(this.saveTimeoutToken),this.saveTimeoutToken=setTimeout(function(){t.templateJustLoaded||(t.isDiffTemplate()?t.saveTemplateMain({}):t.saveTemplate()),t.templateJustLoaded=!1},1e3)):(t.templateJustLoaded||(t.isTemplateSaved=!1),t.templateJustLoaded=!1)},e.prototype.onEditorCreated=function(){this.templateJustLoaded=!1,this.toggleEditors()},e.prototype.saveTemplateMain=function(e){var t,s=this.modalElement.querySelectorAll("vlocity-template-diff");if(s&&s.length>0){var i=s[0].getEditor(),a=i.getModels(),o=a.filter(function(e){return"diffhtml"===e.id}),n=a.filter(function(e){return"diffscss"===e.id}),l=a.filter(function(e){return"diffjavascript"===e.id});this.diffTemplate=Object.assign({},this.diffTemplate,((t={})[this.nsPrefix+"HTML__c"]=o[o.length-1].getValue(),t[this.nsPrefix+"CustomJavascript__c"]=l[l.length-1].getValue(),t[this.nsPrefix+"Sass__c"]=n[n.length-1].getValue(),t)),this.saveTemplate(e,this.diffTemplate,i.getModelMarkers())}},e.prototype.toggleDiffActivation=function(e,t){var s,i,a,o,n=e.target;t?(this.template=Object.assign({},this.template,((s={})[this.nsPrefix+"Active__c"]=n.checked,s)),this.template.Name===this.diffTemplate.Name&&n.checked&&this.diffTemplate[this.nsPrefix+"Active__c"]&&(this.diffTemplate=Object.assign({},this.diffTemplate,((i={})[this.nsPrefix+"Active__c"]=!1,i))),this.saveTemplate(e)):(this.diffTemplate=Object.assign({},this.diffTemplate,((a={})[this.nsPrefix+"Active__c"]=n.checked,a)),this.template.Name===this.diffTemplate.Name&&n.checked&&this.template[this.nsPrefix+"Active__c"]&&(this.template=Object.assign({},this.template,((o={})[this.nsPrefix+"Active__c"]=!1,o))),this.saveTemplateMain(e)),this.isToggleActivation=!0,console.log("template ",this.template)},e.prototype.componentDidLoad=function(){this.initLoad(),this.enableShortCuts()},e.prototype.initLoad=function(){var e=this;this.templateSvc.isInsidePckg().then(function(t){e.isInsidePackage=t}),this.loadTemplateConfiguration(this.nsPrefix+"TemplateDesignerConfiguration__c"),this.diffTemplateId?this.getDiffTemplates():this.templateId?this.loadTemplate():this.templateName&&this.loadTemplateByName(),this.loadAllTemplates(),this.getSassMixins()},e.prototype.previewIcon=function(){return'<svg class="slds-button__icon slds-button__icon_left" aria-hidden="true" ><use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#preview"></use></svg>Preview'},e.prototype.render=function(){var e=this;if(this.diffMode=this.isDiffTemplate(),this.template&&this.template.Id&&(!this.diffTemplateId||this.diffTemplate)){var t=this.modal?"slds-modal__container":"";return o("section",{id:"template-designer",role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1",class:"slds-modal slds-fade-in-open"},o("div",{class:t},o("header",{class:"slds-modal__header"},this.diffMode?o("div",null,o("div",{class:"slds-grid slds-wrap"},o("div",{class:"slds-col slds-size_3-of-12 slds-text-align_left  slds-custom-text"},"Name : ",o("a",{href:"javascript:void(0);",onClick:function(){return e.changeTemplate(e.template.Id,!1,!0)}}," ",this.template.Name)," (V",this.template[this.nsPrefix+"Version__c"],")",o("p",null,"Author : ",this.template[this.nsPrefix+"Author__c"]," "),o("div",{class:"slds-form-element"},o("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},o("span",{class:""},"Active :"),o("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc",id:"templateActive",checked:this.template[this.nsPrefix+"Active__c"],onChange:function(t){return e.toggleDiffActivation(t,!0)}}),o("span",{id:"toggle-desc",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},o("span",{class:"slds-checkbox_faux"}))))),o("div",{class:"slds-col slds-size_6-of-12"},o("h2",{id:"modal-heading-01",class:"slds-text-heading_small slds-hyphenate"},o("span",null,"Template Diff",o("span",{class:"vloc-spinner-holder "+(this.isSavingTemplate?"slds-show":"slds-hide")},o("div",{role:"status",class:"slds-spinner slds-spinner_small slds-spinner_brand slds-m-left_x-small custom-spinner"},o("span",{class:"slds-assistive-text"},"Loading"),o("div",{class:"slds-spinner__dot-a"}),o("div",{class:"slds-spinner__dot-b"}))))),o("div",{class:"slds-form-element__control slds-p-top--x-small"},o("span",{class:"slds-badge slds-badge_inverse slds-m-right_x-small slds-float_left vloc-diff-popover-holder"},"Readonly",o("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},o("div",{class:"slds-popover__body"},"Left side templates are readonly"))),o("div",{class:"slds-radio_button-group"},o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"html",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"html"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"html"},o("span",{class:"slds-radio_faux"},"HTML"))),o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"scss",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"scss"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"scss"},o("span",{class:"slds-radio_faux"},"CSS"))),o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"javascript",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"javascript"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"javascript"},o("span",{class:"slds-radio_faux"},"JS")))),this.isTemplateLocked?o("span",{class:"slds-badge slds-badge_inverse slds-m-right_x-small slds-float_right vloc-diff-popover-holder"},"Locked",o("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},o("div",{class:"slds-popover__body"},"Vlocity authored templates are locked"))):o("span",{class:"slds-badge slds-badge_inverse badge-green  slds-m-left_x-small slds-float_right vloc-diff-popover-holder"},"Editable",o("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},o("div",{class:"slds-popover__body"},"Template is editable"))))),o("div",{class:"slds-col slds-size_3-of-12 slds-text-align_right slds-custom-text"},"Name : ",o("a",{href:"javascript:void(0);",onClick:function(){return e.changeTemplate(e.diffTemplate.Id,!0,!0)}},this.diffTemplate.Name,this.isTemplateSaved?"":"*"," ")," (V",this.diffTemplate[this.nsPrefix+"Version__c"],")",o("p",null,"Author : ",this.diffTemplate[this.nsPrefix+"Author__c"]," "),o("div",{class:"slds-form-element slds-float_right "},o("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},o("span",{class:""},"Active :"),o("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc-diff",id:"templateDiffActive",checked:this.diffTemplate[this.nsPrefix+"Active__c"],onChange:function(t){return e.toggleDiffActivation(t,!1)}}),o("span",{id:"toggle-desc-diff",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},o("span",{class:"slds-checkbox_faux"}))))))):o("div",null,o("div",{class:"slds-grid slds-wrap"},o("div",{class:"slds-col slds-size_3-of-12 slds-text-align_left  slds-custom-text"},o("div",{class:"slds-form-element"},o("a",{class:" slds-text-heading_small",href:"/apex/"+this.nsPrefix+"TemplateHome"},"Go Home")),o("div",{class:"slds-form-element"},"Version : ",this.template[this.nsPrefix+"Version__c"],o("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},o("span",{class:""},"Active :"),o("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc",id:"templateActive",checked:this.template[this.nsPrefix+"Active__c"],onChange:function(t){return e.toggleActivation(t)}}),o("span",{id:"toggle-desc",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},o("span",{class:"slds-checkbox_faux"}))))),o("div",{class:"slds-col slds-size_6-of-12"},o("h2",{id:"modal-heading-01",class:"slds-text-heading_small slds-hyphenate"},o("span",null,this.template.Name,this.isTemplateSaved?"":"*",o("span",{class:"slds-badge slds-badge_inverse slds-m-left_x-small vloc-temp-popover-holder "+(this.isTemplateLocked?"":"slds-hide")},"Locked",o("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_left vloc-temp-popover",role:"tooltip",id:"help"},o("div",{class:"slds-popover__body"},"Vlocity authored templates are locked"))),o("span",{class:"vloc-spinner-holder "+(this.isSavingTemplate?"slds-show":"slds-hide")},o("div",{role:"status",class:"slds-spinner slds-spinner_small slds-spinner_brand slds-m-left_x-small custom-spinner"},o("span",{class:"slds-assistive-text"},"Loading"),o("div",{class:"slds-spinner__dot-a"}),o("div",{class:"slds-spinner__dot-b"}))))),o("div",{class:"slds-form-element__control slds-p-top--x-small"},o("div",{class:"slds-radio_button-group"},o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"html",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"html"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"html"},o("span",{class:"slds-radio_faux"},"HTML"))),o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"scss",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"scss"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"scss"},o("span",{class:"slds-radio_faux"},"CSS"))),o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"javascript",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"javascript"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"javascript"},o("span",{class:"slds-radio_faux"},"JS"))),o("span",{class:"slds-button slds-radio_button"},o("input",{type:"radio",name:"radio",id:"edit",value:"on",onChange:function(t){return e.handleRadioChange(t)},checked:"edit"===this.currentEditor}),o("label",{class:"slds-radio_button__label",htmlFor:"edit"},o("span",{class:"slds-radio_faux"},"EDIT")))))),o("div",{class:"slds-col slds-size_3-of-12 slds-text-align_right slds-custom-text"},o("p",null,"Type : ",this.template[this.nsPrefix+"Type__c"]," "),o("p",null,"Author : ",this.template[this.nsPrefix+"Author__c"]," "),o("button",{class:"slds-button slds-button_neutral btn-preview",id:"preview",onClick:function(t){return e.openPreview(t)},innerHTML:this.previewIcon()}))))),this.diffMode?o("div",{class:"slds-modal__content",id:"modal-content-id-1"},o("vlocity-template-diff",{original:this.template[this.nsPrefix+"HTML__c"],latest:this.diffTemplate[this.nsPrefix+"HTML__c"],type:"html",class:"monaco-editor slds-align_absolute-center"}),o("vlocity-template-diff",{original:this.template[this.nsPrefix+"Sass__c"],latest:this.diffTemplate[this.nsPrefix+"Sass__c"],type:"scss",class:"monaco-editor slds-align_absolute-center"}),o("vlocity-template-diff",{original:this.template[this.nsPrefix+"CustomJavascript__c"],latest:this.diffTemplate[this.nsPrefix+"CustomJavascript__c"],type:"javascript",class:"monaco-editor slds-align_absolute-center"})):o("div",{class:"slds-modal__content",id:"modal-content-id-1"},o("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"HTML__c"],type:"html",configuration:this.templateConfiguration,class:"monaco-editor slds-align_absolute-center"}),o("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"Sass__c"],type:"scss",configuration:this.templateConfiguration,class:"monaco-editor slds-align_absolute-center"}),o("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"CustomJavascript__c"],configuration:this.templateConfiguration,type:"javascript",class:"monaco-editor slds-align_absolute-center"}),o("vlocity-template-info",{type:"edit",nsPrefix:this.nsPrefix,template:this.template}),o("vlocity-template-preview",{type:"preview",templateId:this.templateId})),this.diffMode?o("footer",{class:"slds-modal__footer"},o("div",{class:"slds-grid slds-wrap"},o("div",{class:"slds-col slds-size_6-of-12 slds-text-align_center"},o("button",{class:"slds-button slds-button_brand",onClick:function(){return e.open()}},"Open")),o("div",{class:"slds-col slds-size_6-of-12 slds-text-align_center"},o("button",{class:"slds-button slds-button_brand",onClick:function(){return e.open(!0)}},"Open"),o("button",{disabled:this.isSavingTemplate||this.isTemplateLocked,class:"slds-button slds-button_neutral",onClick:function(t){return e.saveTemplateMain(t)}},"Save"),o("button",{class:"slds-button slds-button_neutral slds-float_right",onClick:function(){return e.help()}},"Help"),o("button",{class:"slds-button slds-button_brand slds-float_right ",onClick:function(){return e.changeTemplate(e.parentTemplate?e.parentTemplate.Id:e.template.Id,!0,!0)}},"Go Back")))):o("footer",{class:"slds-modal__footer slds-modal__footer_directional"},o("button",{class:"slds-button slds-button_brand",onClick:function(){return e.open()}},"New/Open"),o("button",{class:"slds-button slds-button_neutral",onClick:function(){return e.openSettings()}},"Settings"),o("button",{class:"slds-button slds-button_neutral",onClick:function(){return e.help()}},"Help"),o("button",{class:"slds-button slds-button_neutral",onClick:function(){return e.clone()}},"Clone"),o("button",{class:"slds-button slds-button_neutral",disabled:this.isSavingTemplate||this.isTemplateLocked,onClick:function(){return e.createVersion()}},"Create Version"),o("button",{disabled:this.isSavingTemplate||this.isTemplateLocked,class:"slds-button slds-button_neutral",onClick:function(t){return e.saveTemplate(t)}},"Save"))),o("div",{id:"sldsToast",class:"toast-container"}))}return o("section",{id:"template-designer",role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1",class:"slds-modal slds-fade-in-open"},o("div",{class:t}),o("div",{id:"sldsToast",class:"toast-container"}))},Object.defineProperty(e,"is",{get:function(){return"vlocity-template-editor"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{currentEditor:{state:!0},diffTemplate:{state:!0},diffTemplateId:{type:String,attr:"diff-template-id",mutable:!0},htmlTest:{state:!0},isNewTemplate:{state:!0},isSavingTemplate:{state:!0},isTemplateLocked:{state:!0},isTemplateSaved:{state:!0},modal:{type:Boolean,attr:"modal"},modalElement:{elementRef:!0},template:{state:!0},templateConfiguration:{state:!0},templateId:{type:String,attr:"template-id",mutable:!0},templateName:{type:String,attr:"template-name",mutable:!0},templates:{state:!0},templateTypes:{type:"Any",attr:"template-types"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"events",{get:function(){return[{name:"saveCompleted",method:"saveCompleted",bubbles:!0,cancelable:!0,composed:!0},{name:"templateLoaded",method:"templateLoaded",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"listeners",{get:function(){return[{name:"modalRendered",method:"modalRenderedHandler"},{name:"templateLoaded",method:"onTemplateLoaded"},{name:"changeInTemplateInfo",method:"changeInTemplateInfoHandler"},{name:"editorContentChanged",method:"templateChangeHandler"},{name:"onEditorCreated",method:"onEditorCreated"}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".via-slds .slds-input::-webkit-input-placeholder,.via-slds .slds-textarea::-webkit-input-placeholder{color:#d3d3d3}.via-slds .slds-input:-ms-input-placeholder,.via-slds .slds-textarea:-ms-input-placeholder{color:#d3d3d3}.via-slds .slds-input::-ms-input-placeholder,.via-slds .slds-textarea::-ms-input-placeholder{color:#d3d3d3}.via-slds .slds-input::placeholder,.via-slds .slds-textarea::placeholder{color:#d3d3d3}.monaco-editor{min-height:100%;overflow:hidden!important}.slds-modal__content{overflow:hidden!important;height:calc(100vh - 160px)}.icon-custom_check{background:green;border-radius:100px;padding:2px 3px 5px 5px}.icon-custom_share{background:#1b5297;border-radius:100px;padding:1px 3px 4px 5px}.toast-container{position:fixed;z-index:99999;top:0;right:0}.icon-holder{padding-top:6px}.custom-table-cell-width{max-width:200px!important}.custom-icon-height{height:25px}.slds-modal__content pre{display:block;padding:9.5px;margin:0 0 10px;font-size:11px;line-height:1.428571429;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:3px}.slds-modal__content code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:3px}.new-tab-icon{fill:#117aba!important}.pointer-none{pointer-events:none}.diff-icon{fill:#159587!important}.disabled-icon{pointer-events:none;opacity:.2}.slds-custom-text{font-size:14px}.btn-preview{line-height:26px!important;font-size:13px!important}.vloc-toggle{width:100px!important}.badge-green{background:#39ae5f!important}.vloc-modal-container-first:hover .slds-popover.vloc-modal-popover{display:block}.vloc-modal-container-first .slds-popover.vloc-modal-popover{display:none;position:absolute;top:42px;left:-52px}.vloc-modal-container-second:hover .slds-popover.vloc-modal-popover{display:block}.vloc-modal-container-second .slds-popover.vloc-modal-popover{display:none;position:absolute;top:42px;left:2px}.via-slds .vloc-diff-popover-holder{cursor:pointer}.via-slds .vloc-diff-popover-holder .slds-popover.vloc-diff-popover{position:absolute;top:0;margin-left:-50px;visibility:hidden}.via-slds .vloc-diff-popover-holder:hover .vloc-diff-popover{visibility:visible}.via-slds .vloc-temp-popover-holder{cursor:pointer}.via-slds .vloc-temp-popover-holder.slds-badge{line-height:18px}.via-slds .vloc-temp-popover-holder .slds-popover.vloc-temp-popover{position:absolute;top:8px;margin-left:20px;visibility:hidden}.via-slds .vloc-temp-popover-holder:hover .vloc-temp-popover{visibility:visible}.vloc-spinner-holder{position:relative;display:inline-block;height:15px}.vloc-spinner-holder .custom-spinner{position:relative!important}.vloc-spinner-holder.slds-show{display:inline-block!important}.via-slds .action-holder{width:120px}.via-slds .template-list th{cursor:pointer}.via-slds .template-list th:hover svg{opacity:1}.fixedHeaderContainer{height:350px;width:100%}.fixedHeaderContainer .fixedHeader{height:100%}.fixedHeaderContainer .marginLeft10{margin-left:10px}.fixedHeaderContainer .marginLeft71{margin-left:71px}.fixedHeaderContainer .marginLeft31{margin-left:31px}.fixedHeaderContainer .marginLeft60{margin-left:60px}"},enumerable:!0,configurable:!0}),e}();e.SldsToast=n,e.VlocityMonacoEditor=l,e.VlocityTemplateEditor=p,Object.defineProperty(e,"__esModule",{value:!0})});