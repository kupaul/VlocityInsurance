/*! Built with http://stenciljs.com */
const{h:e}=window.VlocityTemplateEditor;import{a as t,b as s,c as i}from"./chunk-e90a3301.js";import{a}from"./chunk-e948ef5c.js";class l{constructor(){}stateClassSelection(e){var t="slds-theme_info";switch(e){case"info":t="slds-theme_info";break;case"success":t="slds-theme_success";break;case"warning":t="slds-theme_warning";break;case"error":t="slds-theme_error"}return t}stateClassIconSelection(e){var t={title:"info",sprite:"utility",icon:"info"};switch(e){case"success":t={title:"success",sprite:"utility",icon:"success"};break;case"warning":t={title:"warning",sprite:"utility",icon:"warning"};break;case"error":t={title:"error",sprite:"utility",icon:"error"}}return t}positionClassSelection(e){var t="slds-text-align_right";switch(e){case"left":t="slds-text-align_left";break;case"center":t="slds-text-align_center";break;case"right":t="slds-text-align_right"}return t}removeToast(){var e=document.querySelector("slds-toast[toastid='"+this.toastid+"']");e.classList.add("fadeout"),setTimeout(()=>{e.parentNode.removeChild(e)},500)}componentDidUnload(){}componentDidLoad(){let e=this;"true"!==this.sticky&&setTimeout(function(){e.removeToast()},e.timeout?e.timeout:4e3)}generateIcon(e,t,s,i){return'<svg aria-hidden="true" class="slds-button__icon slds-button__icon_large" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/apexpages/slds/latest/assets/icons/'+t+"-sprite/svg/symbols.svg#"+s+'"></use></svg><span class="slds-assistive-text">'+e+"</span>"}render(){var t=this.stateClassSelection(this.state),s=this.positionClassSelection(this.position),i=this.stateClassIconSelection(this.state);return e("div",{class:""+s},e("div",{class:"slds-notify slds-notify_toast "+t,role:"alert"},e("span",{class:"slds-assistive-text"},this.state),e("span",{class:"slds-icon_container slds-icon-utility-success slds-m-right_small slds-no-flex slds-align-top",title:this.description,innerHTML:this.generateIcon(i.title,i.sprite,i.icon)}),this.title&&""!==this.title?e("div",{class:"slds-notify__content"},e("h2",{class:"slds-text-heading_small "}," ",this.title," "),e("p",null,this.message)):e("div",{class:"slds-notify__content"},e("h2",{class:"slds-text-heading_small "},this.message)),e("button",{class:"slds-button slds-button_icon slds-notify__close slds-button_icon-inverse",title:"Close",onClick:()=>this.removeToast(),innerHTML:this.generateIcon("close","utility","close",!0)})))}static get is(){return"slds-toast"}static get properties(){return{description:{type:String,attr:"description"},message:{type:String,attr:"message"},position:{type:String,attr:"position"},state:{type:String,attr:"state"},sticky:{type:String,attr:"sticky"},timeout:{type:String,attr:"timeout"},title:{type:String,attr:"title"},toastid:{type:String,attr:"toastid"}}}static get style(){return"\@keyframes fadein{0%{opacity:0}100%{opacity:1}}\@-webkit-keyframes fadein{0%{opacity:0}100%{opacity:1}}\@keyframes fadeout{0%{opacity:1}100%{opacity:0}}\@-webkit-keyframes fadeout{0%{opacity:1}100%{opacity:0}}slds-toast div{-webkit-animation:.5s ease 0s normal forwards 1 fadein;animation:.5s ease 0s normal forwards 1 fadein}slds-toast.fadeout div{-webkit-animation:.5s ease 0s normal forwards 1 fadeout;animation:.5s ease 0s normal forwards 1 fadeout}"}}class o{constructor(){this.nsPrefix=t(),this.position=0}show(){this.editorElement.classList.add("slds-show"),this.editorElement.classList.remove("slds-hide")}hide(){this.editorElement.classList.remove("slds-show"),this.editorElement.classList.add("slds-hide")}getText(){return this.editor.getValue()}isReadOnly(e){this.editor&&this.editor.updateOptions({readOnly:e})}updateSettings(e){"undefined"!=typeof monaco&&(monaco.editor.setTheme(e.theme),this.editor.updateOptions(e))}getModelMarkers(){return monaco.editor.getModelMarkers({})}getEditor(){return monaco.editor}getAllThemes(){let e=[];return this.editor._themeService._knownThemes.forEach(function(t){e.push(t.id)}),e}componentDidLoad(){const e=this;require(["vs/editor/editor.main"],()=>{e.editor=monaco.editor.create(e.editorElement,{value:e.text,language:e.type,automaticLayout:!0,theme:this.configuration&&this.configuration[this.nsPrefix+"EditorTheme__c"]||null,fontSize:this.configuration&&this.configuration[this.nsPrefix+"FontSize__c"]||null}),e.editor.onDidChangeModelContent(()=>{e.editor.hasTextFocus()&&e.editorContentChanged.emit()}),monaco.editor.onDidCreateEditor(()=>{e.onEditorCreated.emit()})}),this.observer=new MutationObserver(()=>{this.editor&&this.editor.layout()}),this.observer.observe(this.editorElement,{attributes:!0,attributeFilter:["class"],childList:!1,characterData:!1})}componentDidUnload(){this.observer.disconnect(),this.editor.dispose()}componentWillUpdate(){this.position=this.editor?this.editor.getPosition():null}componentDidUpdate(){this.editor&&(void 0===this.text&&this.editor.setValue(""),this.editor.setPosition(this.position))}render(){return""}static get is(){return"vlocity-monaco-editor"}static get properties(){return{configuration:{type:"Any",attr:"configuration"},editor:{state:!0},editorElement:{elementRef:!0},getAllThemes:{method:!0},getEditor:{method:!0},getModelMarkers:{method:!0},getText:{method:!0},hide:{method:!0},isReadOnly:{method:!0},observer:{state:!0},show:{method:!0},text:{type:String,attr:"text",mutable:!0},theme:{type:String,attr:"theme"},type:{type:String,attr:"type"},updateSettings:{method:!0}}}static get events(){return[{name:"textChanged",method:"textChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"editorContentChanged",method:"editorContentChanged",bubbles:!0,cancelable:!0,composed:!0},{name:"onEditorCreated",method:"onEditorCreated",bubbles:!0,cancelable:!0,composed:!0}]}static get style(){return""}}class n{constructor(e,s,i){this.actionsList=e,this.config=i,this.remoteActionsList={},this.nsPrefix=t(),this.invokeFunction=((e,...t)=>{let s=this.nsPrefix.replace("__","");return new Promise(function(i,a){let l={action:`${s}.${n.className}.${e}`,config:{escape:!1}};var o=[];o.push(l.action);for(var r=0;r<t.length;r++)o.push(t[r]);o.push((e,t)=>{!e&&!1===t.status&&(t.errors&&t.errors.length>0||"exception"===t.type)&&("exception"===t.type&&/STORAGE_LIMIT_EXCEEDED/.test(t.message)?alert(t.message+".\n You can increase your storage limit by contacting Salesforce or deleting unwanted data."):t.errors&&t.errors instanceof Array&&t.errors.forEach(function(e){"STORAGE_LIMIT_EXCEEDED"===e.status&&alert(e.message+".\n You can increase your storage limit by contacting Salesforce or deleting unwanted data.")})),t.statusCode<400?i(e):a(t)}),o.push(l.config);var d=Visualforce.remoting.Manager.invokeAction;console.log("invokeArgs ",o),d.apply(Visualforce.remoting.Manager,o)})}),this.setupRemoteActions=(()=>{for(var e of(console.log("inside setup"),this.actionsList))this[e]=(()=>{console.log("test function");let t={action:`${this.nsPrefix.replace("__","")}.${n.className}.${e}`,config:{escape:!1}};var s=[];s.push(t.action),s.push((e,t)=>{console.log(e,t)}),s.push(t.config);var i=Visualforce.remoting.Manager.invokeAction;console.log("invokeArgs ",s),i.apply(Visualforce.remoting.Manager,s)});console.log("actions are ",this.remoteActionsList)}),n.className=s,console.log(`yay remote actions from ${n.className} ${e}`),this.setupRemoteActions()}}class r{constructor(){this.templateActions=new n(["getTemplates","getTemplate","getTemplateTypes","getTemplateByName","saveTemplate","getSassMixins","saveTemplateBypass","getCustomSettings","saveTemplateDesignerConfiguration","getTemplatesByIds"],"TemplateController",null)}getTemplates(){return this.templateActions.invokeFunction("getTemplates")}getTemplate(e){return this.templateActions.invokeFunction("getTemplate",e)}getTemplateTypes(){}getTemplatesByIds(e){return this.templateActions.invokeFunction("getTemplatesByIds",e)}getTemplateByName(e){return this.templateActions.invokeFunction("getTemplateByName",e)}saveTemplate(e){return delete e.LastModifiedDate,this.templateActions.invokeFunction("saveTemplateBypass",e)}getSassMixins(){return this.templateActions.invokeFunction("getSassMixins")}isInsidePckg(){return this.templateActions.invokeFunction("isInsidePckg")}getCustomSettings(e){return this.templateActions.invokeFunction("getCustomSettings",e)}saveTemplateDesignerConfiguration(e){return this.templateActions.invokeFunction("saveTemplateDesignerConfiguration",e)}}const d="vlocity"===window.orgName.toLowerCase()?"vlocityDev":window.orgName;var c,h;!function(e){e.save="mod+s",e.open="mod+o",e.help="mod+h",e.activate="mod+shift+a",e.preview="mod+shift+p",e.html="mod+1",e.scss="mod+2",e.javascript="mod+3",e.edit="mod+4"}(h||(h={}));class m{constructor(){this.isTemplateLocked=!1,this.modal=!1,this.templateTypes=[],this.template={},this.templates=[],this.currentEditor="html",this.isSavingTemplate=!1,this.isNewTemplate=!1,this.templateConfiguration={},this.diffTemplate={},this.isTemplateSaved=!0,this.templateSvc=new r,this.nsPrefix=t(),this.sass=new Sass,this.mixins=[],this.saveTimeoutToken=null,this.templateJustLoaded=!0,this.diffMode=!1,this.isSaveEditBlock=!1,this.parentTemplate=void 0,this.isToggleActivation=!1,this.isInsidePackage=!1,this.sortingObj={isSorting:!1,field:"Name",reverse:!1},this.templateId=this.templateId||s.id,this.templateName=this.templateName||s.name,this.diffTemplateId=this.diffTemplateId||s.diffid,console.log("fileNsPrefix ",this.nsPrefix)}loadTemplate(){let e=this;this.templateSvc.getTemplate(this.templateId).then(t=>{this.handleTemplateLoaded(t,e)}).catch(function(e){console.log("err ",e)}),window.addEventListener("beforeunload",function(t){if(!e.isTemplateSaved)return t.returnValue="Do you want to ignore changes you made?\nYour changes will be lost if you don't save them.","Do you want to ignore changes you made?\nYour changes will be lost if you don't save them."})}loadTemplateById(e,t){this.templateSvc.getTemplate(e).then(e=>{t?(this.templateJustLoaded=!0,this.isTemplateSaved=!0,this.diffTemplate=Object.assign({},e),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.diffTemplate[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors()):this.template=Object.assign({},e),this.setTabTitle(this)}).catch(function(e){console.log("err ",e)})}loadTemplateByName(){let e=this;this.templateSvc.getTemplateByName(this.templateName).then(t=>{this.handleTemplateLoaded(t,e)}).catch(function(e){console.log("err ",e)})}getSassMixins(){let e=this;this.mixins.length<=0&&this.templateSvc.getSassMixins().then(t=>{this.mixins=t,this.mixins.forEach(function(t){e.sass.writeFile(t.Name,t[e.nsPrefix+"Sass__c"])})}).catch(function(e){console.log("err ",e)})}loadTemplateConfiguration(e){this.templateSvc.getCustomSettings(e).then(e=>{(e="string"==typeof e?JSON.parse(e):e)[0]&&e[0][this.nsPrefix+"EditorTheme__c"]?(this.templateConfiguration=Object.assign({},e[0]),this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]=this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||d):this.saveTemplateConfiguration()}).catch(function(e){console.log("err ",e)})}saveTemplateConfiguration(){let e=this;this.templateSvc.saveTemplateDesignerConfiguration(this.getEditorCustomSettings()).then(t=>{this.templateConfiguration=Object.assign({},t);const s=this.modalElement.querySelectorAll("vlocity-monaco-editor");for(let e=0;e<s.length;e++){let t=s[e],i={};i.theme=this.templateConfiguration[this.nsPrefix+"EditorTheme__c"],i.fontSize=this.templateConfiguration[this.nsPrefix+"FontSize__c"],i.wordWrap=this.templateConfiguration[this.nsPrefix+"WordWrap__c"]?"on":"off",t.updateSettings(i)}this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]=this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||d;let i=document.querySelector("#settingsModal");i&&(i.parentNode.removeChild(i),e.showToast("success","Settings saved!",""))}).catch(function(t){e.showToast("error","Error Saving","Template designer configuration","0",!0),console.log("err ",t)})}getEditorCustomSettings(){let e=document.querySelector("#editorTheme"),t=document.querySelector("#fontSize"),s=document.querySelector("#defaultAuthor"),i=document.querySelector("#autoSave"),a=document.querySelector("#wordWrap"),l={};return l[this.nsPrefix+"EditorTheme__c"]=e?e.value:this.templateConfiguration[this.nsPrefix+"EditorTheme__c"]||"vs-dark",l[this.nsPrefix+"FontSize__c"]=t?t.value:this.templateConfiguration[this.nsPrefix+"FontSize__c"]||"15",l[this.nsPrefix+"DefaultAuthor__c"]=s?s.value:this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||s,l[this.nsPrefix+"AutoSave__c"]=i?i.checked:this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||!1,l[this.nsPrefix+"WordWrap__c"]=a?a.checked:this.templateConfiguration[this.nsPrefix+"WordWrap__c"]||!1,l}setTabTitle(e){if(document.querySelector("#sldsToast").innerHTML="",document.title=this.isDiffTemplate()?"Template Diff":this.template&&this.template.Name||"Loading...",sforce.console&&sforce.console.isInConsole())if(this.isNewTemplate){let t;sforce.console.getEnclosingTabId(function(e){t=e.id,setTimeout(function(){sforce.console.closeTab(e.id)},0)}),sforce.console.getEnclosingPrimaryTabId(function(s){t===s.id?sforce.console.openPrimaryTab(null,c,!1,e.template.Name,null,null,null):sforce.console.openSubtab(s.id,c,!1,e.template.Name,null,null,null)})}else sforce.console.getEnclosingTabId(function(t){let s=t.id;sforce.console.setTabTitle(e.template.Name,s)})}handleTemplateLoaded(e,t){this.template=Object.assign({},e),this.setTabTitle(this),this.templateId=this.template.Id,console.log("template ",this.template),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors(),this.templateLoaded.emit(t.template)}enableShortCuts(){let e=new a;e.bindGlobal(h.save,function(){this.diffMode?this.saveTemplateMain():this.saveTemplate()},this),e.bindGlobal(h.open,function(){!this.diffMode&&this.open()},this),e.bindGlobal(h.help,this.help,this),e.bindGlobal(h.activate,function(){!this.diffMode&&this.toggleShortcutActivation()},this),e.bindGlobal(h.preview,function(){!this.diffMode&&this.tabKeyChange("preview")},this),e.bindGlobal(h.html,function(){this.tabKeyChange("html")},this),e.bindGlobal(h.scss,function(){this.tabKeyChange("scss")},this),e.bindGlobal(h.javascript,function(){this.tabKeyChange("javascript")},this),e.bindGlobal(h.edit,function(){!this.diffMode&&this.tabKeyChange("edit")},this)}sortAlphabetically(){let e=[...this.templates];e.sort(function(e,t){return e.Name.localeCompare(t.Name)}),this.templates=[...e]}loadAllTemplates(){let e=this;this.templates.length<=0&&this.templateSvc.getTemplates().then(t=>{this.templates=t,this.templates.forEach(function(t){-1===e.templateTypes.indexOf(t[e.nsPrefix+"Type__c"])&&e.templateTypes.push(t[e.nsPrefix+"Type__c"])}),this.templateId||this.open(),console.log("template ",this.templates),this.sortAlphabetically()}).catch(function(e){console.log("err ",e)})}tabKeyChange(e){this.currentEditor=e,this.toggleEditors()}handleRadioChange(e){const t=e.target;!0===t.checked&&(this.currentEditor=t.id,this.toggleEditors())}toggleShortcutActivation(){const e=document.getElementById("templateActive");e.checked=!e.checked,this.template=Object.assign({},this.template,{[this.nsPrefix+"Active__c"]:e.checked}),this.isToggleActivation=!0,this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||this.saveTemplate(),console.log("template ",this.template)}toggleActivation(e){const t=e.target;this.template=Object.assign({},this.template,{[this.nsPrefix+"Active__c"]:t.checked}),this.templateConfiguration[this.nsPrefix+"AutoSave__c"]||this.saveTemplate(e),this.isToggleActivation=!0,console.log("template ",this.template)}openPreview(e){const t=e.target;this.currentEditor=t.id,this.toggleEditors()}toggleEditors(){console.log(this.template);const e=this.modalElement.querySelectorAll("vlocity-monaco-editor, vlocity-template-info, vlocity-template-preview, vlocity-template-diff");for(let t=0;t<e.length;t++){let s=e[t];s.getAttribute("type")===this.currentEditor?(s.show(),this.isTemplateLocked&&s.isReadOnly?s.isReadOnly(!0):s.isReadOnly&&s.isReadOnly(!1)):s.hide()}}showToast(e,t,s,i,a){var l=document.createElement("slds-toast");l.setAttribute("state",e),l.setAttribute("title",s||""),l.setAttribute("message",t),l.setAttribute("toastid","toast"+Date.now()),l.setAttribute("timeout",i||"4000"),l.setAttribute("sticky",a+"");var o=document.getElementById("sldsToast");o.insertBefore(l,o.firstChild)}showModal(){var e=document.createElement("slds-modal");e.setAttribute("modalid","modal-123"),e.setAttribute("title","My Title"),e.innerHTML='<pre slot="modal-content">test</pre>',document.getElementById("template-designer").appendChild(e)}syncEditorChanges(e){if(this.templateJustLoaded)return e;const t=this.modalElement.querySelectorAll("vlocity-monaco-editor");for(let s=0;s<t.length;s++){let i=t[s];switch(i.getAttribute("type")){case"html":e=Object.assign({},e,{[this.nsPrefix+"HTML__c"]:i.getText()});break;case"javascript":e=Object.assign({},e,{[this.nsPrefix+"CustomJavascript__c"]:i.getText()});break;case"scss":e=Object.assign({},e,{[this.nsPrefix+"Sass__c"]:i.getText()})}}return e}getAllMarkers(){const e=this.modalElement.querySelectorAll("vlocity-monaco-editor");if(e&&e.length>0)return e[0].getModelMarkers()}saveTemplate(e,t,s){if(this.isSavingTemplate)return;this.isSavingTemplate=!0;const i=this;let a=t||this.syncEditorChanges(this.template),l=t?s:this.getAllMarkers();(l=(l=l||[]).filter(e=>3===e.severity)).length>0&&(console.log(l),i.isSavingTemplate=!1,l.forEach(function(e){i.showToast("error",e.message+" line: "+e.startLineNumber,e.owner&&e.owner.toUpperCase(),"0",!0)})),this.sass.compile(a[this.nsPrefix+"Sass__c"]||"",function(e){if(i.templateJustLoaded=!i.isSaveEditBlock,1===e.status)return console.log("error ",e),l.find(function(t){return e.line===t.startLineNumber&&e.column===t.startColumn})||i.showToast("error",e.message+" line : "+e.line,"CSS","0",!0),void(i.isSavingTemplate=!1);if(!e.status||3===e.status){if(l&&l.length>0)return;console.log("compiled Sass ",e),a=Object.assign({},a,{[i.nsPrefix+"CSS__c"]:e.text?e.text:""}),i.templateSvc.saveTemplate(a).then(e=>{i.isSavingTemplate=!1,i.isTemplateSaved=!0,i.isToggleActivation?(i.showToast(a[i.nsPrefix+"Active__c"]?"success":"info",a[i.nsPrefix+"Active__c"]?"Template Activated":"Template Deactivated",a.Name+" (V"+a[i.nsPrefix+"Version__c"]+")","2000"),i.isToggleActivation=!1):i.showToast("success","Saved Successfully!",a.Name+" (V"+a[i.nsPrefix+"Version__c"]+")","2000"),i.templates.filter(function(t){return t.Name===e.Name}).forEach(function(t){e[i.nsPrefix+"Active__c"]&&(t[i.nsPrefix+"Active__c"]=!1),t[i.nsPrefix+"Author__c"]===e[i.nsPrefix+"Author__c"]&&t[i.nsPrefix+"Version__c"]===e[i.nsPrefix+"Version__c"]&&(t[i.nsPrefix+"Active__c"]=e[i.nsPrefix+"Active__c"],t.LastModifiedDate=e.LastModifiedDate)}),console.log("saved ",e)}).catch(function(e){i.isSavingTemplate=!1,i.showToast("error","Error Saving",a.Name,"0",!0),console.log("err ",e)})}}),console.log("template ",this.template,e)}createVersion(){let e=Object.assign({},this.template),t=1;const s=this;delete(e=this.syncEditorChanges(e)).Id,delete e[this.nsPrefix+"ExternalID__c"],this.templates.filter(function(t){return t.Name===e.Name&&t[s.nsPrefix+"Author__c"]===e[s.nsPrefix+"Author__c"]}).forEach(function(e){t=e[s.nsPrefix+"Version__c"]>t?e[s.nsPrefix+"Version__c"]:t}),e[this.nsPrefix+"Version__c"]=t+1,e[this.nsPrefix+"Active__c"]=!1,e[this.nsPrefix+"Definition__c"]=this.template[this.nsPrefix+"Definition__c"],this.isSavingTemplate=!0;let i=this;this.templateSvc.saveTemplate(e).then(e=>{this.isSavingTemplate=!1,this.isNewTemplate=!this.templateId,s.template=Object.assign({},e),s.showToast("success","Version created Successfully"),s.templates.push(s.template),this.templateLoaded.emit(s.template),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors(),console.log("saved ",e)}).catch(function(e){i.isSavingTemplate=!1,s.showToast("error","Error Saving","","0",!0),console.log("err ",e)})}open(e){const t=this;let s="";var a=document.createElement("slds-modal");a.setAttribute("Id","openModal"),a.setAttribute("title","Template Manager"),a.setAttribute("size","medium"),a.setAttribute("enable-close",this.templateId?"true":"false"),this.sortingObj.isSorting=!1,s=`<div slot="modal-content">\n                        <div class="slds-tabs_default">\n                        <ul class="slds-tabs_default__nav  custom-tab" id="tabSelect" role="tablist">\n                        <li class="slds-tabs_default__item ${this.templateId?"slds-is-active":""}" title="Item One" role="presentation"><a data-tabId="tab1" class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-default-1" id="tab-default-1__item">Select Template</a></li>\n                        <li class="slds-tabs_default__item ${(this.templateId?"":"slds-is-active ")+(this.diffMode?"slds-hide":"")}" title="Item Two" role="presentation"><a data-tabId="tab2" class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-default-2" id="tab-default-2__item">Create Template</a></li>\n                        </ul>\n                        <div id="tab1" class="slds-tabs_default__content tab-content ${this.templateId?"slds-show":"slds-hide"} role="tabpanel" aria-labelledby="tab-default-1__item">\n                        <div class="slds-p-top_small slds-p-horizontal_x-large template-search-box">\n                        <input id="searchTemplate"  class="slds-input" placeholder="Enter Name" type="text" /></div>\n                        <div class="slds-grid slds-wrap slds-grid--vertical-stretch template-list"  id="templateList">\n                        ${this.generateTemplate(this.templates)}\n                        </div></div>\n                        </div>\n                        <div id="tab2" class="slds-tabs_default__content tab-content ${this.templateId?"slds-hide":"slds-show"} role="tabpanel" aria-labelledby="tab-default-2__item">\n                        <div class="new-template-content">\n                        <div id="modalInnerError" class="slds-text-color--error slds-p-vertical_x-small"></div>\n                        ${this.createInputElem("newTemplateName","Template Name","Enter Name","","",!0)+this.createInputElem("newTemplateAuthor","Template Author","Enter Author",this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"],"",!0)+this.createComboBoxElem("newTemplateType","Template Type","Enter Template Type",this.templateTypes,"",!0)}\n                        </div>\n                        </div></div>\n                        ${this.templateId?`<button slot="modal-footer" id="btnCreate" class="slds-button slds-button_brand ${this.templateId?"slds-hide":""}">Create</button>`:`<div class="slds-float_right" slot="modal-footer"><button  id="btnCreate" class="slds-button slds-button_brand ${this.templateId?"slds-hide":""}">Create</button>\n                        <a href="${"/apex/"+this.nsPrefix+"TemplateHome"}" class="slds-button slds-button_neutral " >Go Home</a>\n                        </div>`}`,a.innerHTML=s,document.getElementById("template-designer").appendChild(a),document.getElementById("searchTemplate").addEventListener("keyup",function(){let e=this,s=t.templates.filter(t=>t.Name.toLowerCase().includes(e.value.toLowerCase()));document.getElementById("templateList").innerHTML=t.generateTemplate(s)}),document.getElementById("templateList").addEventListener("click",function(s){let a=s.target;if(a.getAttribute("data-templateid")&&t.changeTemplate(a.getAttribute("data-templateid"),e),a.getAttribute("template-href")&&i(a.getAttribute("template-href"),s,!0),a.getAttribute("diff-templateid")){t.parentTemplate=t.parentTemplate?t.parentTemplate:t.template,t.updateUrl("diffid",a.getAttribute("diff-templateid")),t.diffTemplate=void 0,t.diffTemplateId=a.getAttribute("diff-templateid"),t.initLoad();let e=document.querySelector("#openModal");e.parentNode.removeChild(e)}if(a.getAttribute("data-sort-field")){let e=a.getAttribute("data-sort-field"),s=!1;a.querySelector("svg").classList.contains("slds-transition-show")&&a.querySelector("svg use").href.baseVal.includes("arrowup")&&(s=!0),t.sortingObj.reverse=s,t.sortTemplates(e,s)}}),document.getElementById("tabSelect").addEventListener("click",function(e){let t=e.target,s="";t.getAttribute("data-tabId")&&(s=this.getElementsByTagName("li"),[].forEach.call(s,function(e){e.classList.remove("slds-is-active")}),t.parentNode.classList.add("slds-is-active"),s=document.getElementsByClassName("tab-content"),[].forEach.call(s,function(e){e.classList.remove("slds-show"),e.classList.add("slds-hide")}),document.getElementById(t.getAttribute("data-tabId")).classList.remove("slds-hide"),document.getElementById(t.getAttribute("data-tabId")).classList.add("slds-show"),document.getElementById("btnCreate").classList.toggle("slds-hide"))}),document.getElementById("btnCreate").addEventListener("click",function(){t.create()})}sortTemplates(e,t){let s=document.getElementById("searchTemplate");this.sortingObj={isSorting:!0,field:e||"Name",reverse:t};let i=JSON.parse(JSON.stringify(this.templates));i=(i=i.sort(this.dynamicSort(this.sortingObj.field,t))).filter(e=>e.Name.toLowerCase().includes(s.value.toLowerCase())),document.getElementById("templateList").innerHTML=this.generateTemplate(i)}dynamicSort(e,t,s){var i=s?function(t){return s(t[e])}:function(t){return"number"==typeof t[e]?t[e]:t[e].toLowerCase()};return t=t?-1:1,function(e,s){return e=i(e),s=i(s),t*((e>s?1:-1)-(s>e?1:-1))}}modalRenderedHandler(){let e=this,t=document.querySelector("#searchTemplate"),s=document.querySelector("#btnClone");t?window.setTimeout(function(){document.getElementById("searchTemplate").focus()},0):s&&window.setTimeout(function(){s.addEventListener("click",function(){e.handleClone()})},0)}updateQueryStringParameter(e,t,s){var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+s+"$2"):e+a+t+"="+s}updateUrl(e,t){let s=this.nsPrefix+"uitemplatedesigner",i=location.href;i.includes(s)||(i=i.replace("uitemplatedesigner",s));let a=this.updateQueryStringParameter(i,e,t);c=a,window.history.pushState({path:a},"",a)}removeUrlParam(e){var t=document.location.href,s=t.split("?");if(s.length>=2){let i=s.shift(),a=s.join("?"),l=encodeURIComponent(e)+"=",o=a.split(/[&;]/g);for(let e=o.length;e-- >0;)-1!==o[e].lastIndexOf(l,0)&&o.splice(e,1);t=i+"?"+o.join("&"),window.history.pushState("",document.title,t)}}generateTemplate(e){let t=this,s=!1,i=function(e){return`<svg aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon ${t.sortingObj.isSorting&&e===t.sortingObj.field?"slds-transition-show":"slds-transition-hide"}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">`+`<use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#${t.sortingObj.reverse?"arrowdown":"arrowup"}"></use>`+"</svg>"};this.templateId||(s=!0);let a='<div class="slds-table--header-fixed_container fixedHeaderContainer"><div class="slds-scrollable_y fixedHeader"><table class="slds-table slds-table_bordered slds-table_striped slds-table--header-fixed"><thead><tr class="slds-text-title_caps"><th scope="col"><div class="slds-truncate slds-cell-fixed marginLeft10" title="Name" data-sort-field="Name"> Name '+i("Name")+'</div></th><th scope="col"><div class="slds-truncate slds-cell-fixed" title="Author" data-sort-field="'+this.nsPrefix+'Author__c"> Author '+i(this.nsPrefix+"Author__c")+'</div></th><th scope="col"><div class="slds-truncate slds-cell-fixed" title="Version">Version </div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed marginLeft60" title="Last Modified Date" data-sort-field="LastModifiedDate">Last Modified Date '+i("LastModifiedDate")+'</div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed" title="Active">Active </div></th><th scope="col"><div class="slds-truncate slds-text-align_center slds-cell-fixed marginLeft31" title="Action">Action </div></th></tr></thead><tbody>',l="",o="";for(let t=0;t<e.length;t++)this.template.Id!==e[t].Id&&(o="/apex/"+this.nsPrefix+"uitemplatedesigner?id="+e[t].Id,l=e[t][this.nsPrefix+"Active__c"]?"":" slds-hide ",a+='<tr><th scope="row" data-label="Name"><div class="slds-truncate custom-table-cell-width" title="Open"><a alt="Open" href="javascript:void(0)" data-templateId="'+e[t].Id+'">'+e[t].Name+'</a></div></th><td data-label="Author"><div class="slds-truncate" title="Author">'+e[t][this.nsPrefix+"Author__c"]+'</div></td><td data-label="Version"><div class="slds-truncate  slds-text-align_center" title="Version">'+e[t][this.nsPrefix+"Version__c"]+'</div></td><td data-label="Version"><div class="slds-truncate  slds-text-align_center" title="Last Modified Date">'+this.getFormattedDateTime(e[t].LastModifiedDate)+'</div></td><td data-label="Active"><div class="slds-truncate  slds-text-align_center   custom-icon-height" title="Active"><span class="'+l+'"><svg aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#success"></use></svg><span class="slds-assistive-text">Active</span></span></div></td><td data-label="Action" class="action-holder"><div class="slds-truncate  slds-text-align_center" title="Open in new tab"><a alt="Open in new tab" template-href="'+o+'" title="Open in new tab" target="_blank" class="slds-p-around_x-small vloc-modal-container-first"><span class=""><svg aria-hidden="true" template-href="'+o+'" class="slds-icon slds-icon--x-small new-tab-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use template-href="'+o+'" xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#new_window"></use></svg><span class="slds-assistive-text">Open</span></span><div class="slds-popover slds-popover_tooltip slds-nubbin_top-right vloc-modal-popover" role="tooltip" id="help" style="position: absolute;"><div class="slds-popover__body">Open in new tab</div></div></a><a alt="Diff" href="javascript:void(0)" diff-templateId="'+e[t].Id+'" class="slds-p-around_x-small vloc-modal-container-second '+(this.diffMode?"slds-hide":"")+(s?" disabled-icon":"")+'" title="Diff" ><svg diff-templateId="'+e[t].Id+'" aria-hidden="true" class="slds-icon slds-icon--x-small diff-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use class="pointer-none" diff-templateId="'+e[t].Id+'" xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#knowledge_base"></use></svg><span class="slds-assistive-text">Diff</span><div class="slds-popover slds-popover_tooltip slds-nubbin_top-right vloc-modal-popover" role="tooltip" id="help" style="position: absolute;"><div class="slds-popover__body">Template Diff</div></div></a></div></td></tr>');return a+"</tbody></table></div></div>"}getFormattedDateTime(e){let t=new Date(e);return t.toLocaleString().split(",")[0]+" "+t.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}changeTemplate(e,t,s){let i=this,a=!0;if(this.isTemplateSaved||this.isDiffTemplate()&&!t&&!s||(a=this.openModal("Do you want to ignore changes you made?\nYour changes will be lost if you don't save them.")),a){this.removeUrlParam("diffid"),this.currentEditor="html",this.diffMode&&!s?(t?(this.diffTemplate=void 0,this.diffTemplateId=e):(this.template=void 0,this.templateId=e),this.loadTemplateById(e,t)):s?(this.template=t?Object.assign({},this.diffTemplate):Object.assign({},this.template),this.templateId=e,this.diffTemplate=void 0,this.diffTemplateId=void 0,this.templateJustLoaded=!0,this.isTemplateSaved=!0,this.setTabTitle(i),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.template.Id!==e&&(this.template=this.parentTemplate,this.parentTemplate=void 0,this.loadTemplate())):(this.diffTemplate=void 0,this.template=void 0,this.diffTemplateId=void 0,this.templateId=e,this.loadTemplate()),this.updateUrl(t&&!s?"diffid":"id",e);let a=document.querySelector("#openModal");a&&a.parentNode.removeChild(a)}}openModal(e){return window.confirm(e)}clone(){let e="";var t=document.createElement("slds-modal");t.setAttribute("Id","cloneModal"),t.setAttribute("title","Clone Template"),e+='<div slot="modal-content" class="slds-p-top_small">'+this.createInputElem("cloneTemplateName","Template Name","Enter Name",this.template.Name)+this.createInputElem("cloneAuthor","Author","Enter Author",this.templateConfiguration[this.nsPrefix+"DefaultAuthor__c"]||this.template[this.nsPrefix+"Author__c"])+this.createComboBoxElem("cloneType","Template Type","Enter Template Type",this.templateTypes,this.template[this.nsPrefix+"Type__c"])+'</div><button slot="modal-footer" id="btnClone" class="slds-button slds-button_brand">Clone</button>',t.innerHTML=e,document.getElementById("template-designer").appendChild(t)}help(){let e="";var t=document.createElement("slds-modal");t.setAttribute("Id","helpModal"),t.setAttribute("title","Help"),e+='<div slot="modal-content"><help-modal></help-modal></div>',t.innerHTML=e,document.getElementById("template-designer").appendChild(t)}openSettings(){let e=this,t="",s=this.getEditorCustomSettings();const i=this.modalElement.querySelectorAll("vlocity-monaco-editor");let a=i&&i.length>0?i[0].getAllThemes():[];var l=document.createElement("slds-modal");l.setAttribute("Id","settingsModal"),l.setAttribute("title","Settings"),t+='<div slot="modal-content"><div id="modalInnerError" class="slds-text-color--error slds-p-vertical_x-small"></div>'+this.createSelectElem("editorTheme","Editor Theme",a,s[this.nsPrefix+"EditorTheme__c"])+this.createInputElem("fontSize","Font Size","Enter Font Size",`${s[this.nsPrefix+"FontSize__c"]}`,"number")+this.createInputElem("defaultAuthor","Default Author","Enter Default Author",`${s[this.nsPrefix+"DefaultAuthor__c"]}`)+this.createCheckboxElem("autoSave","Auto Save",s[this.nsPrefix+"AutoSave__c"])+this.createCheckboxElem("wordWrap","Wordwrap",s[this.nsPrefix+"WordWrap__c"])+'</div><button slot="modal-footer" id="saveSettings" class="slds-button slds-button_brand">Save</button>',l.innerHTML=t,document.getElementById("template-designer").appendChild(l),document.getElementById("saveSettings").addEventListener("click",function(){e.saveTemplateConfiguration()})}create(){let e=document.querySelector("#newTemplateName"),t=document.querySelector("#newTemplateAuthor"),s=document.querySelector("#newTemplateType"),i=document.querySelector("#modalInnerError");const a=this;if(!e.value)return void(i.innerHTML="You must specify template name.");if(!t.value)return void(i.innerHTML="You must specify template author.");if(!s.value)return void(i.innerHTML="You must specify template type.");if(l=e.value,o=t.value,a.templates.find(function(e){return e.Name.toLowerCase()===l.toLowerCase()&&e[a.nsPrefix+"Author__c"].toLowerCase()===o.toLowerCase()}))return void(i.innerHTML="A template with same name and author already exists, try creating a new version.");if(!function(e){return!a.isInsidePackage||"vlocity"!==e.trim().toLowerCase()}(t.value))return void(i.innerHTML="Creating 'Vlocity' authored template is not allowed.");var l,o;let n={};n.Name=e.value,n[this.nsPrefix+"Type__c"]=s.value,n[this.nsPrefix+"Author__c"]=t.value,n[this.nsPrefix+"Version__c"]=1,n[this.nsPrefix+"Active__c"]=!1,this.templateSvc.saveTemplate(n).then(e=>{a.template=Object.assign({},e),a.showToast("success","Created Successfully"),a.templates.push(a.template),this.isNewTemplate=!this.templateId,this.templateLoaded.emit(a.template),this.updateUrl("id",a.template.Id),this.templateId=a.template.Id,this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors(),this.setTabTitle(a);var t=document.querySelector("#openModal");t.parentNode.removeChild(t)}).catch(function(e){a.showToast("error","Error creating template","","0",!0),console.log("err ",e)})}createInputElem(e,t,s,i,a,l){return i=i||"",`<slds-input label="${t}" type="${a=a||"text"}" placeholder="${s}" inputid="${e}" value="${i}" required=${l=l||!1}>  </slds-input>`}createSelectElem(e,t,s,i){return'<slds-select label="'+t+'" selectid="'+e+'" value="'+i+'" options="'+s+'"></slds-select>'}createCheckboxElem(e,t,s){return'<slds-checkbox label="'+t+'" checkboxid="'+e+'" value='+s+"></slds-checkbox>"}createComboBoxElem(e,t,s,i,a,l){return`<slds-combobox label="${t}" comboid="${e}" options="${i}" value="${a}" placeholder="${s}" required=${l}></slds-combobox>`}handleClone(){let e=document.querySelector("#cloneTemplateName"),t=document.querySelector("#cloneAuthor"),s=document.querySelector("#cloneType"),i=document.querySelector("#modalError");const a=this;if(!e.value)return void(i.innerHTML="You must specify template name.");if(!t.value)return void(i.innerHTML="You must specify template author.");if(!s.value)return void(i.innerHTML="You must specify template type.");if(l=e.value,o=t.value,a.templates.find(function(e){return e.Name.toLowerCase()===l.toLowerCase()&&e[a.nsPrefix+"Author__c"].toLowerCase()===o.toLowerCase()}))return void(i.innerHTML="A template with same name and author already exists, try creating a new version.");if(!function(e){return!a.isInsidePackage||"vlocity"!==e.trim().toLowerCase()}(t.value))return void(i.innerHTML="Creating 'Vlocity' authored template is not allowed.");var l,o;let n=Object.assign({},this.template);delete(n=this.syncEditorChanges(n)).Id,delete n[this.nsPrefix+"ExternalID__c"],n.Name=e.value,n[this.nsPrefix+"Type__c"]=s.value,n[this.nsPrefix+"Author__c"]=t.value,n[this.nsPrefix+"Version__c"]=1,n[this.nsPrefix+"Active__c"]=!1,n[this.nsPrefix+"ParentID__c"]=this.template[this.nsPrefix+"ExternalID__c"],n[this.nsPrefix+"Definition__c"]=this.template[this.nsPrefix+"Definition__c"],this.templateSvc.saveTemplate(n).then(e=>{a.template=Object.assign({},e),a.showToast("success","Cloned Successfully"),a.templates.push(a.template),this.templateLoaded.emit(a.template),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.template[this.nsPrefix+"Author__c"].trim().toLowerCase(),this.toggleEditors(),this.setTabTitle(this);var t=document.querySelector("#cloneModal");t.parentNode.removeChild(t)}).catch(function(e){a.showToast("error","Error creating clone","","0",!0),console.log("err ",e)})}isDiffTemplate(){return!(!this.diffTemplateId||!this.diffTemplate)}getDiffTemplates(){let e=this;this.templateSvc.getTemplatesByIds([this.templateId,this.diffTemplateId]).then(t=>{this.templateId==this.diffTemplateId?(this.diffTemplate=Object.assign({},t[0]),this.template=Object.assign({},t[0])):this.templateId===t[1].Id?(this.diffTemplate=Object.assign({},t[0]),this.template=Object.assign({},t[1])):(this.diffTemplate=Object.assign({},t[1]),this.template=Object.assign({},t[0])),this.templateJustLoaded=!0,this.isTemplateSaved=!0,this.setTabTitle(this),this.isTemplateLocked=this.isInsidePackage&&"vlocity"===this.diffTemplate[this.nsPrefix+"Author__c"].trim().toLowerCase(),window.setTimeout(function(){e.toggleEditors()},0)}).catch(function(e){console.log("err ",e)})}onTemplateLoaded(e){this.templateJustLoaded=!0,this.isTemplateSaved=!0;let t=e.detail,s=window.location.href.split(/[?&]/).find(function(e){return/^id\=/.test(e)});if(s&&(s=s.replace(/^id=/,"")),!s||s!==t.Id)if(s){let e=window.location.href.replace(s,t.Id);window.history.pushState("","",e)}else{let e=window.location.pathname+(0===window.location.search.length?"?":window.location.search+"&")+"id="+t.Id;window.history.pushState("","",e)}}changeInTemplateInfoHandler(e){let t=e.detail;this.template=Object.assign({},this.template,{Name:t.Name,[this.nsPrefix+"Description__c"]:t[this.nsPrefix+"Description__c"],[this.nsPrefix+"Author__c"]:t[this.nsPrefix+"Author__c"],[this.nsPrefix+"Definition__c"]:t[this.nsPrefix+"Definition__c"],[this.nsPrefix+"SampleJson__c"]:t[this.nsPrefix+"SampleJson__c"]}),this.templateChangeHandler(!0)}templateChangeHandler(e){this.isSaveEditBlock=e||!1,this.template=this.syncEditorChanges(this.template);let t=this;this.templateConfiguration[this.nsPrefix+"AutoSave__c"]?(this.saveTimeoutToken&&clearTimeout(this.saveTimeoutToken),this.saveTimeoutToken=setTimeout(function(){t.templateJustLoaded||(t.isDiffTemplate()?t.saveTemplateMain({}):t.saveTemplate()),t.templateJustLoaded=!1},1e3)):(t.templateJustLoaded||(t.isTemplateSaved=!1),t.templateJustLoaded=!1)}onEditorCreated(){this.templateJustLoaded=!1,this.toggleEditors()}saveTemplateMain(e){const t=this.modalElement.querySelectorAll("vlocity-template-diff");if(t&&t.length>0){let s=t[0].getEditor(),i=s.getModels(),a=i.filter(function(e){return"diffhtml"===e.id}),l=i.filter(function(e){return"diffscss"===e.id}),o=i.filter(function(e){return"diffjavascript"===e.id});this.diffTemplate=Object.assign({},this.diffTemplate,{[this.nsPrefix+"HTML__c"]:a[a.length-1].getValue(),[this.nsPrefix+"CustomJavascript__c"]:o[o.length-1].getValue(),[this.nsPrefix+"Sass__c"]:l[l.length-1].getValue()}),this.saveTemplate(e,this.diffTemplate,s.getModelMarkers())}}toggleDiffActivation(e,t){const s=e.target;t?(this.template=Object.assign({},this.template,{[this.nsPrefix+"Active__c"]:s.checked}),this.template.Name===this.diffTemplate.Name&&s.checked&&this.diffTemplate[this.nsPrefix+"Active__c"]&&(this.diffTemplate=Object.assign({},this.diffTemplate,{[this.nsPrefix+"Active__c"]:!1})),this.saveTemplate(e)):(this.diffTemplate=Object.assign({},this.diffTemplate,{[this.nsPrefix+"Active__c"]:s.checked}),this.template.Name===this.diffTemplate.Name&&s.checked&&this.template[this.nsPrefix+"Active__c"]&&(this.template=Object.assign({},this.template,{[this.nsPrefix+"Active__c"]:!1})),this.saveTemplateMain(e)),this.isToggleActivation=!0,console.log("template ",this.template)}componentDidLoad(){this.initLoad(),this.enableShortCuts()}initLoad(){let e=this;this.templateSvc.isInsidePckg().then(function(t){e.isInsidePackage=t}),this.loadTemplateConfiguration(this.nsPrefix+"TemplateDesignerConfiguration__c"),this.diffTemplateId?this.getDiffTemplates():this.templateId?this.loadTemplate():this.templateName&&this.loadTemplateByName(),this.loadAllTemplates(),this.getSassMixins()}previewIcon(){return'<svg class="slds-button__icon slds-button__icon_left" aria-hidden="true" ><use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#preview"></use></svg>Preview'}render(){if(this.diffMode=this.isDiffTemplate(),this.template&&this.template.Id&&(!this.diffTemplateId||this.diffTemplate)){var t=this.modal?"slds-modal__container":"";return e("section",{id:"template-designer",role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1",class:"slds-modal slds-fade-in-open"},e("div",{class:t},e("header",{class:"slds-modal__header"},this.diffMode?e("div",null,e("div",{class:"slds-grid slds-wrap"},e("div",{class:"slds-col slds-size_3-of-12 slds-text-align_left  slds-custom-text"},"Name : ",e("a",{href:"javascript:void(0);",onClick:()=>this.changeTemplate(this.template.Id,!1,!0)}," ",this.template.Name)," (V",this.template[this.nsPrefix+"Version__c"],")",e("p",null,"Author : ",this.template[this.nsPrefix+"Author__c"]," "),e("div",{class:"slds-form-element"},e("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},e("span",{class:""},"Active :"),e("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc",id:"templateActive",checked:this.template[this.nsPrefix+"Active__c"],onChange:e=>this.toggleDiffActivation(e,!0)}),e("span",{id:"toggle-desc",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},e("span",{class:"slds-checkbox_faux"}))))),e("div",{class:"slds-col slds-size_6-of-12"},e("h2",{id:"modal-heading-01",class:"slds-text-heading_small slds-hyphenate"},e("span",null,"Template Diff",e("span",{class:"vloc-spinner-holder "+(this.isSavingTemplate?"slds-show":"slds-hide")},e("div",{role:"status",class:"slds-spinner slds-spinner_small slds-spinner_brand slds-m-left_x-small custom-spinner"},e("span",{class:"slds-assistive-text"},"Loading"),e("div",{class:"slds-spinner__dot-a"}),e("div",{class:"slds-spinner__dot-b"}))))),e("div",{class:"slds-form-element__control slds-p-top--x-small"},e("span",{class:"slds-badge slds-badge_inverse slds-m-right_x-small slds-float_left vloc-diff-popover-holder"},"Readonly",e("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},e("div",{class:"slds-popover__body"},"Left side templates are readonly"))),e("div",{class:"slds-radio_button-group"},e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"html",value:"on",onChange:e=>this.handleRadioChange(e),checked:"html"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"html"},e("span",{class:"slds-radio_faux"},"HTML"))),e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"scss",value:"on",onChange:e=>this.handleRadioChange(e),checked:"scss"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"scss"},e("span",{class:"slds-radio_faux"},"CSS"))),e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"javascript",value:"on",onChange:e=>this.handleRadioChange(e),checked:"javascript"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"javascript"},e("span",{class:"slds-radio_faux"},"JS")))),this.isTemplateLocked?e("span",{class:"slds-badge slds-badge_inverse slds-m-right_x-small slds-float_right vloc-diff-popover-holder"},"Locked",e("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},e("div",{class:"slds-popover__body"},"Vlocity authored templates are locked"))):e("span",{class:"slds-badge slds-badge_inverse badge-green  slds-m-left_x-small slds-float_right vloc-diff-popover-holder"},"Editable",e("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_bottom-left vloc-diff-popover",role:"tooltip",id:"help"},e("div",{class:"slds-popover__body"},"Template is editable"))))),e("div",{class:"slds-col slds-size_3-of-12 slds-text-align_right slds-custom-text"},"Name : ",e("a",{href:"javascript:void(0);",onClick:()=>this.changeTemplate(this.diffTemplate.Id,!0,!0)},this.diffTemplate.Name,this.isTemplateSaved?"":"*"," ")," (V",this.diffTemplate[this.nsPrefix+"Version__c"],")",e("p",null,"Author : ",this.diffTemplate[this.nsPrefix+"Author__c"]," "),e("div",{class:"slds-form-element slds-float_right "},e("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},e("span",{class:""},"Active :"),e("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc-diff",id:"templateDiffActive",checked:this.diffTemplate[this.nsPrefix+"Active__c"],onChange:e=>this.toggleDiffActivation(e,!1)}),e("span",{id:"toggle-desc-diff",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},e("span",{class:"slds-checkbox_faux"}))))))):e("div",null,e("div",{class:"slds-grid slds-wrap"},e("div",{class:"slds-col slds-size_3-of-12 slds-text-align_left  slds-custom-text"},e("div",{class:"slds-form-element"},e("a",{class:" slds-text-heading_small",href:"/apex/"+this.nsPrefix+"TemplateHome"},"Go Home")),e("div",{class:"slds-form-element"},"Version : ",this.template[this.nsPrefix+"Version__c"],e("label",{class:"slds-checkbox_toggle slds-grid slds-p-top--xxx-small vloc-toggle"},e("span",{class:""},"Active :"),e("input",{type:"checkbox",disabled:this.isSavingTemplate,name:"checkbox","aria-describedby":"toggle-desc",id:"templateActive",checked:this.template[this.nsPrefix+"Active__c"],onChange:e=>this.toggleActivation(e)}),e("span",{id:"toggle-desc",class:"slds-checkbox_faux_container slds-p-left--xx-small","aria-live":"assertive"},e("span",{class:"slds-checkbox_faux"}))))),e("div",{class:"slds-col slds-size_6-of-12"},e("h2",{id:"modal-heading-01",class:"slds-text-heading_small slds-hyphenate"},e("span",null,this.template.Name,this.isTemplateSaved?"":"*",e("span",{class:"slds-badge slds-badge_inverse slds-m-left_x-small vloc-temp-popover-holder "+(this.isTemplateLocked?"":"slds-hide")},"Locked",e("div",{class:"slds-popover slds-popover_tooltip slds-nubbin_left vloc-temp-popover",role:"tooltip",id:"help"},e("div",{class:"slds-popover__body"},"Vlocity authored templates are locked"))),e("span",{class:"vloc-spinner-holder "+(this.isSavingTemplate?"slds-show":"slds-hide")},e("div",{role:"status",class:"slds-spinner slds-spinner_small slds-spinner_brand slds-m-left_x-small custom-spinner"},e("span",{class:"slds-assistive-text"},"Loading"),e("div",{class:"slds-spinner__dot-a"}),e("div",{class:"slds-spinner__dot-b"}))))),e("div",{class:"slds-form-element__control slds-p-top--x-small"},e("div",{class:"slds-radio_button-group"},e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"html",value:"on",onChange:e=>this.handleRadioChange(e),checked:"html"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"html"},e("span",{class:"slds-radio_faux"},"HTML"))),e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"scss",value:"on",onChange:e=>this.handleRadioChange(e),checked:"scss"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"scss"},e("span",{class:"slds-radio_faux"},"CSS"))),e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"javascript",value:"on",onChange:e=>this.handleRadioChange(e),checked:"javascript"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"javascript"},e("span",{class:"slds-radio_faux"},"JS"))),e("span",{class:"slds-button slds-radio_button"},e("input",{type:"radio",name:"radio",id:"edit",value:"on",onChange:e=>this.handleRadioChange(e),checked:"edit"===this.currentEditor}),e("label",{class:"slds-radio_button__label",htmlFor:"edit"},e("span",{class:"slds-radio_faux"},"EDIT")))))),e("div",{class:"slds-col slds-size_3-of-12 slds-text-align_right slds-custom-text"},e("p",null,"Type : ",this.template[this.nsPrefix+"Type__c"]," "),e("p",null,"Author : ",this.template[this.nsPrefix+"Author__c"]," "),e("button",{class:"slds-button slds-button_neutral btn-preview",id:"preview",onClick:e=>this.openPreview(e),innerHTML:this.previewIcon()}))))),this.diffMode?e("div",{class:"slds-modal__content",id:"modal-content-id-1"},e("vlocity-template-diff",{original:this.template[this.nsPrefix+"HTML__c"],latest:this.diffTemplate[this.nsPrefix+"HTML__c"],type:"html",class:"monaco-editor slds-align_absolute-center"}),e("vlocity-template-diff",{original:this.template[this.nsPrefix+"Sass__c"],latest:this.diffTemplate[this.nsPrefix+"Sass__c"],type:"scss",class:"monaco-editor slds-align_absolute-center"}),e("vlocity-template-diff",{original:this.template[this.nsPrefix+"CustomJavascript__c"],latest:this.diffTemplate[this.nsPrefix+"CustomJavascript__c"],type:"javascript",class:"monaco-editor slds-align_absolute-center"})):e("div",{class:"slds-modal__content",id:"modal-content-id-1"},e("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"HTML__c"],type:"html",configuration:this.templateConfiguration,class:"monaco-editor slds-align_absolute-center"}),e("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"Sass__c"],type:"scss",configuration:this.templateConfiguration,class:"monaco-editor slds-align_absolute-center"}),e("vlocity-monaco-editor",{text:this.template[this.nsPrefix+"CustomJavascript__c"],configuration:this.templateConfiguration,type:"javascript",class:"monaco-editor slds-align_absolute-center"}),e("vlocity-template-info",{type:"edit",nsPrefix:this.nsPrefix,template:this.template}),e("vlocity-template-preview",{type:"preview",templateId:this.templateId})),this.diffMode?e("footer",{class:"slds-modal__footer"},e("div",{class:"slds-grid slds-wrap"},e("div",{class:"slds-col slds-size_6-of-12 slds-text-align_center"},e("button",{class:"slds-button slds-button_brand",onClick:()=>this.open()},"Open")),e("div",{class:"slds-col slds-size_6-of-12 slds-text-align_center"},e("button",{class:"slds-button slds-button_brand",onClick:()=>this.open(!0)},"Open"),e("button",{disabled:this.isSavingTemplate||this.isTemplateLocked,class:"slds-button slds-button_neutral",onClick:e=>this.saveTemplateMain(e)},"Save"),e("button",{class:"slds-button slds-button_neutral slds-float_right",onClick:()=>this.help()},"Help"),e("button",{class:"slds-button slds-button_brand slds-float_right ",onClick:()=>this.changeTemplate(this.parentTemplate?this.parentTemplate.Id:this.template.Id,!0,!0)},"Go Back")))):e("footer",{class:"slds-modal__footer slds-modal__footer_directional"},e("button",{class:"slds-button slds-button_brand",onClick:()=>this.open()},"New/Open"),e("button",{class:"slds-button slds-button_neutral",onClick:()=>this.openSettings()},"Settings"),e("button",{class:"slds-button slds-button_neutral",onClick:()=>this.help()},"Help"),e("button",{class:"slds-button slds-button_neutral",onClick:()=>this.clone()},"Clone"),e("button",{class:"slds-button slds-button_neutral",disabled:this.isSavingTemplate||this.isTemplateLocked,onClick:()=>this.createVersion()},"Create Version"),e("button",{disabled:this.isSavingTemplate||this.isTemplateLocked,class:"slds-button slds-button_neutral",onClick:e=>this.saveTemplate(e)},"Save"))),e("div",{id:"sldsToast",class:"toast-container"}))}return e("section",{id:"template-designer",role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1",class:"slds-modal slds-fade-in-open"},e("div",{class:t}),e("div",{id:"sldsToast",class:"toast-container"}))}static get is(){return"vlocity-template-editor"}static get properties(){return{currentEditor:{state:!0},diffTemplate:{state:!0},diffTemplateId:{type:String,attr:"diff-template-id",mutable:!0},htmlTest:{state:!0},isNewTemplate:{state:!0},isSavingTemplate:{state:!0},isTemplateLocked:{state:!0},isTemplateSaved:{state:!0},modal:{type:Boolean,attr:"modal"},modalElement:{elementRef:!0},template:{state:!0},templateConfiguration:{state:!0},templateId:{type:String,attr:"template-id",mutable:!0},templateName:{type:String,attr:"template-name",mutable:!0},templates:{state:!0},templateTypes:{type:"Any",attr:"template-types"}}}static get events(){return[{name:"saveCompleted",method:"saveCompleted",bubbles:!0,cancelable:!0,composed:!0},{name:"templateLoaded",method:"templateLoaded",bubbles:!0,cancelable:!0,composed:!0}]}static get listeners(){return[{name:"modalRendered",method:"modalRenderedHandler"},{name:"templateLoaded",method:"onTemplateLoaded"},{name:"changeInTemplateInfo",method:"changeInTemplateInfoHandler"},{name:"editorContentChanged",method:"templateChangeHandler"},{name:"onEditorCreated",method:"onEditorCreated"}]}static get style(){return".via-slds .slds-input::-webkit-input-placeholder,.via-slds .slds-textarea::-webkit-input-placeholder{color:#d3d3d3}.via-slds .slds-input:-ms-input-placeholder,.via-slds .slds-textarea:-ms-input-placeholder{color:#d3d3d3}.via-slds .slds-input::-ms-input-placeholder,.via-slds .slds-textarea::-ms-input-placeholder{color:#d3d3d3}.via-slds .slds-input::placeholder,.via-slds .slds-textarea::placeholder{color:#d3d3d3}.monaco-editor{min-height:100%;overflow:hidden!important}.slds-modal__content{overflow:hidden!important;height:calc(100vh - 160px)}.icon-custom_check{background:green;border-radius:100px;padding:2px 3px 5px 5px}.icon-custom_share{background:#1b5297;border-radius:100px;padding:1px 3px 4px 5px}.toast-container{position:fixed;z-index:99999;top:0;right:0}.icon-holder{padding-top:6px}.custom-table-cell-width{max-width:200px!important}.custom-icon-height{height:25px}.slds-modal__content pre{display:block;padding:9.5px;margin:0 0 10px;font-size:11px;line-height:1.428571429;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:3px}.slds-modal__content code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:3px}.new-tab-icon{fill:#117aba!important}.pointer-none{pointer-events:none}.diff-icon{fill:#159587!important}.disabled-icon{pointer-events:none;opacity:.2}.slds-custom-text{font-size:14px}.btn-preview{line-height:26px!important;font-size:13px!important}.vloc-toggle{width:100px!important}.badge-green{background:#39ae5f!important}.vloc-modal-container-first:hover .slds-popover.vloc-modal-popover{display:block}.vloc-modal-container-first .slds-popover.vloc-modal-popover{display:none;position:absolute;top:42px;left:-52px}.vloc-modal-container-second:hover .slds-popover.vloc-modal-popover{display:block}.vloc-modal-container-second .slds-popover.vloc-modal-popover{display:none;position:absolute;top:42px;left:2px}.via-slds .vloc-diff-popover-holder{cursor:pointer}.via-slds .vloc-diff-popover-holder .slds-popover.vloc-diff-popover{position:absolute;top:0;margin-left:-50px;visibility:hidden}.via-slds .vloc-diff-popover-holder:hover .vloc-diff-popover{visibility:visible}.via-slds .vloc-temp-popover-holder{cursor:pointer}.via-slds .vloc-temp-popover-holder.slds-badge{line-height:18px}.via-slds .vloc-temp-popover-holder .slds-popover.vloc-temp-popover{position:absolute;top:8px;margin-left:20px;visibility:hidden}.via-slds .vloc-temp-popover-holder:hover .vloc-temp-popover{visibility:visible}.vloc-spinner-holder{position:relative;display:inline-block;height:15px}.vloc-spinner-holder .custom-spinner{position:relative!important}.vloc-spinner-holder.slds-show{display:inline-block!important}.via-slds .action-holder{width:120px}.via-slds .template-list th{cursor:pointer}.via-slds .template-list th:hover svg{opacity:1}.fixedHeaderContainer{height:350px;width:100%}.fixedHeaderContainer .fixedHeader{height:100%}.fixedHeaderContainer .marginLeft10{margin-left:10px}.fixedHeaderContainer .marginLeft71{margin-left:71px}.fixedHeaderContainer .marginLeft31{margin-left:31px}.fixedHeaderContainer .marginLeft60{margin-left:60px}"}}export{l as SldsToast,o as VlocityMonacoEditor,m as VlocityTemplateEditor};