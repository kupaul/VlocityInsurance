{"version":3,"sources":["iframeResizer.contentWindow.js"],"names":["undefined","addEventListener","el","evt","func","window","attachEvent","removeEventListener","detachEvent","capitalizeFirstLetter","string","charAt","toUpperCase","slice","throttle","context","args","result","timeout","previous","later","getNow","apply","now","remaining","throttledTimer","this","arguments","clearTimeout","setTimeout","formatLogMsg","msg","msgID","myID","log","logging","console","warn","init","readDataFromParent","location","href","readDataFromPage","setMargin","setBodyStyle","bodyBackground","bodyPadding","injectClearFixIntoBodyElement","checkHeightMode","checkWidthMode","stopInfiniteResizingOfIFrame","setupPublicMethods","startEventListeners","inPageLinks","setupInPageLinks","sendSize","readyCallback","strBool","str","data","initMsg","substr","msgIdLen","split","bodyMargin","Number","calculateWidth","interval","autoResize","bodyMarginStr","heightCalcMode","tolerance","enable","resizeFrom","widthCalcMode","readData","iFrameResizer","JSON","stringify","messageCallback","targetOriginDefault","targetOrigin","heightCalculationMethod","widthCalculationMethod","setupCustomCalcMethods","calcMode","calcFunc","customCalcMethods","Object","constructor","chkCSS","attr","value","indexOf","document","body","style","documentElement","height","manageTriggerEvent","options","listener","add","eventName","handleEvent","eventType","eventHandlersByName","remove","eventNames","Array","prototype","map","method","manageEventListeners","checkCalcMode","calcModeDefault","modes","type","heightCalcModeDefault","getHeight","widthCalcModeDefault","getWidth","setupMutationObserver","stopMsgsToParent","sendPermit","removeMsgListener","receiver","disconnectMutationObserver","bodyObserver","disconnect","stopEventListeners","clearInterval","intervalTimer","teardown","clearFix","createElement","clear","display","appendChild","getPagePosition","x","pageXOffset","scrollLeft","y","pageYOffset","scrollTop","getElementPosition","elPosition","getBoundingClientRect","pagePosition","parseInt","left","top","findTarget","jumpToTarget","target","jumpPosition","hash","sendMsg","hashData","decodeURIComponent","getElementById","getElementsByName","checkLocationHash","bindAnchors","setupLink","linkClicked","e","preventDefault","getAttribute","forEach","call","querySelectorAll","bindLocationHash","initCheck","eventCancelTimer","enableInPageLinks","win","parentIFrame","resize","close","getId","getPageInfo","callback","pageInfoCallback","moveToAnchor","reset","resetIFrame","scrollTo","scrollToOffset","sendMessage","setHeightCalculationMethod","setWidthCalculationMethod","setTargetOrigin","size","customHeight","customWidth","initInterval","setInterval","Math","abs","setupBodyMutationObserver","addImageLoadListners","mutation","addImageLoadListener","element","complete","src","imageLoaded","imageError","elements","push","attributeName","removeFromArray","splice","removeImageLoadListener","imageEventTriggered","event","typeDesc","mutationObserved","mutations","createMutationObserver","querySelector","config","attributes","attributeOldValue","characterData","characterDataOldValue","childList","subtree","observer","MutationObserver","observe","WebKitMutationObserver","forceIntervalTimer","getComputedStyle","prop","convertUnitsToPxForIE8","test","base","runtimeStyle","currentStyle","pixelLeft","retVal","defaultView","chkEventThottle","timer","getMaxElement","side","useMargin","elementsLength","length","elVal","maxVal","Side","i","marginHeight","getAllMeasurements","dimention","bodyOffset","bodyScroll","documentElementOffset","documentElementScroll","getTaggedElements","tag","noTaggedElementsFound","getAllElements","getAllElementsIgnore","ignored","ignoreSelector","from","filter","includes","sizeIFrame","triggerEvent","triggerEventDesc","resizeIFrame","currentHeight","width","currentWidth","isSizeChangeDetected","checkTolarance","a","b","isForceResizableEvent","isForceResizableCalcMode","resetRequiredMethods","logIgnored","checkDownSizing","lockTrigger","recordTrigger","resetPage","isDoubleFiredEvent","triggerLocked","doubleEventList","sizeIFrameThrottled","triggerLockedTimer","triggerReset","hcm","sendToParent","message","postMessage","isMessageForUs","getMessageType","getData","isMiddleTier","module","exports","isInitMsg","true","false","callFromParent","messageType","processRequestFromParent","processMessage","firstRun","fireInit","source","initLock","initFromParent","inPageLink","pageInfo","msgBody","parse","chkLateLoaded","readyState","parent","toStr","toString","isCallable","fn","toInteger","number","isNaN","isFinite","floor","maxSafeInteger","pow","toLength","len","min","max","arrayLike","C","items","TypeError","T","mapFn","kValue","A","k","defineProperty","searchElement","fromIndex","o","n","click","offsetHeight","scrollWidth","Date","getTime","offset","scrollHeight","custom","grow","lowestElement","taggedElement","lowestElementNoMargin","offsetWidth","scroll","rightMostElement"],"mappings":"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","file":"iframeResizer.contentWindow.min.js","sourcesContent":["/*\n * File: iframeResizer.contentWindow.js\n * Desc: Include this file in any page being loaded into an iframe\n *       to force the iframe to resize to the content size.\n * Requires: iframeResizer.js on host page.\n * Doc: https://github.com/davidjbradshaw/iframe-resizer\n * Author: David J. Bradshaw - dave@bradshaw.net\n * Contributor: Jure Mav - jure.mav@gmail.com\n * Contributor: Ian Caunce - ian@hallnet.co.uk\n */\n\n\n; (function (undefined) {\n\t'use strict';\n\n\n\tif (!Array.from) {\n\t\tArray.from = (function () {\n\t\t  var toStr = Object.prototype.toString;\n\t\t  var isCallable = function (fn) {\n\t\t\treturn typeof fn === 'function' || toStr.call(fn) === '[object Function]';\n\t\t  };\n\t\t  var toInteger = function (value) {\n\t\t\tvar number = Number(value);\n\t\t\tif (isNaN(number)) { return 0; }\n\t\t\tif (number === 0 || !isFinite(number)) { return number; }\n\t\t\treturn (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));\n\t\t  };\n\t\t  var maxSafeInteger = Math.pow(2, 53) - 1;\n\t\t  var toLength = function (value) {\n\t\t\tvar len = toInteger(value);\n\t\t\treturn Math.min(Math.max(len, 0), maxSafeInteger);\n\t\t  };\n\t  \n\t\t  // The length property of the from method is 1.\n\t\t  return function from(arrayLike/*, mapFn, thisArg */) {\n\t\t\t// 1. Let C be the this value.\n\t\t\tvar C = this;\n\t  \n\t\t\t// 2. Let items be ToObject(arrayLike).\n\t\t\tvar items = Object(arrayLike);\n\t  \n\t\t\t// 3. ReturnIfAbrupt(items).\n\t\t\tif (arrayLike == null) {\n\t\t\t  throw new TypeError('Array.from requires an array-like object - not null or undefined');\n\t\t\t}\n\t  \n\t\t\t// 4. If mapfn is undefined, then let mapping be false.\n\t\t\tvar mapFn = arguments.length > 1 ? arguments[1] : void undefined;\n\t\t\tvar T;\n\t\t\tif (typeof mapFn !== 'undefined') {\n\t\t\t  // 5. else\n\t\t\t  // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.\n\t\t\t  if (!isCallable(mapFn)) {\n\t\t\t\tthrow new TypeError('Array.from: when provided, the second argument must be a function');\n\t\t\t  }\n\t  \n\t\t\t  // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.\n\t\t\t  if (arguments.length > 2) {\n\t\t\t\tT = arguments[2];\n\t\t\t  }\n\t\t\t}\n\t  \n\t\t\t// 10. Let lenValue be Get(items, \"length\").\n\t\t\t// 11. Let len be ToLength(lenValue).\n\t\t\tvar len = toLength(items.length);\n\t  \n\t\t\t// 13. If IsConstructor(C) is true, then\n\t\t\t// 13. a. Let A be the result of calling the [[Construct]] internal method \n\t\t\t// of C with an argument list containing the single item len.\n\t\t\t// 14. a. Else, Let A be ArrayCreate(len).\n\t\t\tvar A = isCallable(C) ? Object(new C(len)) : new Array(len);\n\t  \n\t\t\t// 16. Let k be 0.\n\t\t\tvar k = 0;\n\t\t\t// 17. Repeat, while k < len… (also steps a - h)\n\t\t\tvar kValue;\n\t\t\twhile (k < len) {\n\t\t\t  kValue = items[k];\n\t\t\t  if (mapFn) {\n\t\t\t\tA[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);\n\t\t\t  } else {\n\t\t\t\tA[k] = kValue;\n\t\t\t  }\n\t\t\t  k += 1;\n\t\t\t}\n\t\t\t// 18. Let putStatus be Put(A, \"length\", len, true).\n\t\t\tA.length = len;\n\t\t\t// 20. Return A.\n\t\t\treturn A;\n\t\t  };\n\t\t}());\n\t  }\n\t// https://tc39.github.io/ecma262/#sec-array.prototype.includes\nif (!Array.prototype.includes) {\n\tObject.defineProperty(Array.prototype, 'includes', {\n\t  value: function(searchElement, fromIndex) {\n  \n\t\t// 1. Let O be ? ToObject(this value).\n\t\tif (this == null) {\n\t\t  throw new TypeError('\"this\" is null or not defined');\n\t\t}\n  \n\t\tvar o = Object(this);\n  \n\t\t// 2. Let len be ? ToLength(? Get(O, \"length\")).\n\t\tvar len = o.length >>> 0;\n  \n\t\t// 3. If len is 0, return false.\n\t\tif (len === 0) {\n\t\t  return false;\n\t\t}\n  \n\t\t// 4. Let n be ? ToInteger(fromIndex).\n\t\t//    (If fromIndex is undefined, this step produces the value 0.)\n\t\tvar n = fromIndex | 0;\n  \n\t\t// 5. If n ≥ 0, then\n\t\t//  a. Let k be n.\n\t\t// 6. Else n < 0,\n\t\t//  a. Let k be len + n.\n\t\t//  b. If k < 0, let k be 0.\n\t\tvar k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n  \n\t\t// 7. Repeat, while k < len\n\t\twhile (k < len) {\n\t\t  // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n\t\t  // b. If SameValueZero(searchElement, elementK) is true, return true.\n\t\t  // c. Increase k by 1.\n\t\t  // NOTE: === provides the correct \"SameValueZero\" comparison needed here.\n\t\t  if (o[k] === searchElement) {\n\t\t\treturn true;\n\t\t  }\n\t\t  k++;\n\t\t}\n  \n\t\t// 8. Return false\n\t\treturn false;\n\t  }\n\t});\n  }\n\n\tif (typeof window === 'undefined') return; // don't run for server side render\n\n\tvar\n\t\tautoResize = true,\n\t\tbase = 10,\n\t\tbodyBackground = '',\n\t\tbodyMargin = 0,\n\t\tbodyMarginStr = '',\n\t\tbodyObserver = null,\n\t\tbodyPadding = '',\n\t\tcalculateWidth = false,\n\t\tdoubleEventList = { 'resize': 1, 'click': 1 },\n\t\teventCancelTimer = 128,\n\t\tfirstRun = true,\n\t\theight = 1,\n\t\theightCalcModeDefault = 'bodyOffset',\n\t\theightCalcMode = heightCalcModeDefault,\n\t\tinitLock = true,\n\t\tinitMsg = '',\n\t\tinPageLinks = {},\n\t\tinterval = 32,\n\t\tintervalTimer = null,\n\t\tlogging = false,\n\t\tmsgID = '[iFrameSizer]',  //Must match host page msg ID\n\t\tmsgIdLen = msgID.length,\n\t\tmyID = '',\n\t\tobserver = null,\n\t\tresetRequiredMethods = { max: 1, min: 1, bodyScroll: 1, documentElementScroll: 1 },\n\t\tresizeFrom = 'child',\n\t\tsendPermit = true,\n\t\ttarget = window.parent,\n\t\ttargetOriginDefault = '*',\n\t\ttolerance = 0,\n\t\ttriggerLocked = false,\n\t\ttriggerLockedTimer = null,\n\t\tthrottledTimer = 16,\n\t\twidth = 1,\n\t\twidthCalcModeDefault = 'scroll',\n\t\twidthCalcMode = widthCalcModeDefault,\n\t\twin = window,\n\t\tmessageCallback = function () { warn('MessageCallback function not defined'); },\n\t\treadyCallback = function () { },\n\t\tpageInfoCallback = function () { },\n\t\tcustomCalcMethods = {\n\t\t\theight: function () {\n\t\t\t\twarn('Custom height calculation function not defined');\n\t\t\t\treturn document.documentElement.offsetHeight;\n\t\t\t},\n\t\t\twidth: function () {\n\t\t\t\twarn('Custom width calculation function not defined');\n\t\t\t\treturn document.body.scrollWidth;\n\t\t\t}\n\t\t},\n\t\teventHandlersByName = {};\n\n\n\tfunction addEventListener(el, evt, func) {\n\t\t/* istanbul ignore else */ // Not testable in phantonJS\n\t\tif ('addEventListener' in window) {\n\t\t\tel.addEventListener(evt, func, false);\n\t\t} else if ('attachEvent' in window) { //IE\n\t\t\tel.attachEvent('on' + evt, func);\n\t\t}\n\t}\n\n\tfunction removeEventListener(el, evt, func) {\n\t\t/* istanbul ignore else */ // Not testable in phantonJS\n\t\tif ('removeEventListener' in window) {\n\t\t\tel.removeEventListener(evt, func, false);\n\t\t} else if ('detachEvent' in window) { //IE\n\t\t\tel.detachEvent('on' + evt, func);\n\t\t}\n\t}\n\n\tfunction capitalizeFirstLetter(string) {\n\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\n\t}\n\n\t//Based on underscore.js\n\tfunction throttle(func) {\n\t\tvar\n\t\t\tcontext, args, result,\n\t\t\ttimeout = null,\n\t\t\tprevious = 0,\n\t\t\tlater = function () {\n\t\t\t\tprevious = getNow();\n\t\t\t\ttimeout = null;\n\t\t\t\tresult = func.apply(context, args);\n\t\t\t\tif (!timeout) {\n\t\t\t\t\tcontext = args = null;\n\t\t\t\t}\n\t\t\t};\n\n\t\treturn function () {\n\t\t\tvar now = getNow();\n\n\t\t\tif (!previous) {\n\t\t\t\tprevious = now;\n\t\t\t}\n\n\t\t\tvar remaining = throttledTimer - (now - previous);\n\n\t\t\tcontext = this;\n\t\t\targs = arguments;\n\n\t\t\tif (remaining <= 0 || remaining > throttledTimer) {\n\t\t\t\tif (timeout) {\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout = null;\n\t\t\t\t}\n\n\t\t\t\tprevious = now;\n\t\t\t\tresult = func.apply(context, args);\n\n\t\t\t\tif (!timeout) {\n\t\t\t\t\tcontext = args = null;\n\t\t\t\t}\n\n\t\t\t} else if (!timeout) {\n\t\t\t\ttimeout = setTimeout(later, remaining);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\tvar getNow = Date.now || function () {\n\t\t/* istanbul ignore next */ // Not testable in PhantonJS\n\t\treturn new Date().getTime();\n\t};\n\n\tfunction formatLogMsg(msg) {\n\t\treturn msgID + '[' + myID + ']' + ' ' + msg;\n\t}\n\n\tfunction log(msg) {\n\t\tif (logging && ('object' === typeof window.console)) {\n\t\t\tconsole.log(formatLogMsg(msg));\n\t\t}\n\t}\n\n\tfunction warn(msg) {\n\t\tif ('object' === typeof window.console) {\n\t\t\tconsole.warn(formatLogMsg(msg));\n\t\t}\n\t}\n\n\n\tfunction init() {\n\t\treadDataFromParent();\n\t\tlog('Initialising iFrame (' + location.href + ')');\n\t\treadDataFromPage();\n\t\tsetMargin();\n\t\tsetBodyStyle('background', bodyBackground);\n\t\tsetBodyStyle('padding', bodyPadding);\n\t\tinjectClearFixIntoBodyElement();\n\t\tcheckHeightMode();\n\t\tcheckWidthMode();\n\t\tstopInfiniteResizingOfIFrame();\n\t\tsetupPublicMethods();\n\t\tstartEventListeners();\n\t\tinPageLinks = setupInPageLinks();\n\t\tsendSize('init', 'Init message from host page');\n\t\treadyCallback();\n\t}\n\n\tfunction readDataFromParent() {\n\n\t\tfunction strBool(str) {\n\t\t\treturn 'true' === str ? true : false;\n\t\t}\n\n\t\tvar data = initMsg.substr(msgIdLen).split(':');\n\n\t\tmyID = data[0];\n\t\tbodyMargin = (undefined !== data[1]) ? Number(data[1]) : bodyMargin; //For V1 compatibility\n\t\tcalculateWidth = (undefined !== data[2]) ? strBool(data[2]) : calculateWidth;\n\t\tlogging = (undefined !== data[3]) ? strBool(data[3]) : logging;\n\t\tinterval = (undefined !== data[4]) ? Number(data[4]) : interval;\n\t\tautoResize = (undefined !== data[6]) ? strBool(data[6]) : autoResize;\n\t\tbodyMarginStr = data[7];\n\t\theightCalcMode = (undefined !== data[8]) ? data[8] : heightCalcMode;\n\t\tbodyBackground = data[9];\n\t\tbodyPadding = data[10];\n\t\ttolerance = (undefined !== data[11]) ? Number(data[11]) : tolerance;\n\t\tinPageLinks.enable = (undefined !== data[12]) ? strBool(data[12]) : false;\n\t\tresizeFrom = (undefined !== data[13]) ? data[13] : resizeFrom;\n\t\twidthCalcMode = (undefined !== data[14]) ? data[14] : widthCalcMode;\n\t}\n\n\tfunction readDataFromPage() {\n\t\tfunction readData() {\n\t\t\tvar data = window.iFrameResizer;\n\n\t\t\tlog('Reading data from page: ' + JSON.stringify(data));\n\n\t\t\tmessageCallback = ('messageCallback' in data) ? data.messageCallback : messageCallback;\n\t\t\treadyCallback = ('readyCallback' in data) ? data.readyCallback : readyCallback;\n\t\t\ttargetOriginDefault = ('targetOrigin' in data) ? data.targetOrigin : targetOriginDefault;\n\t\t\theightCalcMode = ('heightCalculationMethod' in data) ? data.heightCalculationMethod : heightCalcMode;\n\t\t\twidthCalcMode = ('widthCalculationMethod' in data) ? data.widthCalculationMethod : widthCalcMode;\n\t\t}\n\n\t\tfunction setupCustomCalcMethods(calcMode, calcFunc) {\n\t\t\tif ('function' === typeof calcMode) {\n\t\t\t\tlog('Setup custom ' + calcFunc + 'CalcMethod');\n\t\t\t\tcustomCalcMethods[calcFunc] = calcMode;\n\t\t\t\tcalcMode = 'custom';\n\t\t\t}\n\n\t\t\treturn calcMode;\n\t\t}\n\n\t\tif (('iFrameResizer' in window) && (Object === window.iFrameResizer.constructor)) {\n\t\t\treadData();\n\t\t\theightCalcMode = setupCustomCalcMethods(heightCalcMode, 'height');\n\t\t\twidthCalcMode = setupCustomCalcMethods(widthCalcMode, 'width');\n\t\t}\n\n\t\tlog('TargetOrigin for parent set to: ' + targetOriginDefault);\n\t}\n\n\n\tfunction chkCSS(attr, value) {\n\t\tif (-1 !== value.indexOf('-')) {\n\t\t\twarn('Negative CSS value ignored for ' + attr);\n\t\t\tvalue = '';\n\t\t}\n\t\treturn value;\n\t}\n\n\tfunction setBodyStyle(attr, value) {\n\t\tif ((undefined !== value) && ('' !== value) && ('null' !== value)) {\n\t\t\tdocument.body.style[attr] = value;\n\t\t\tlog('Body ' + attr + ' set to \"' + value + '\"');\n\t\t}\n\t}\n\n\tfunction setMargin() {\n\t\t//If called via V1 script, convert bodyMargin from int to str\n\t\tif (undefined === bodyMarginStr) {\n\t\t\tbodyMarginStr = bodyMargin + 'px';\n\t\t}\n\n\t\tsetBodyStyle('margin', chkCSS('margin', bodyMarginStr));\n\t}\n\n\tfunction stopInfiniteResizingOfIFrame() {\n\t\tdocument.documentElement.style.height = '';\n\t\tdocument.body.style.height = '';\n\t\tlog('HTML & body height set to \"auto\"');\n\t}\n\n\n\tfunction manageTriggerEvent(options) {\n\n\t\tvar listener = {\n\t\t\tadd: function (eventName) {\n\t\t\t\tfunction handleEvent() {\n\t\t\t\t\tsendSize(options.eventName, options.eventType);\n\t\t\t\t}\n\n\t\t\t\teventHandlersByName[eventName] = handleEvent;\n\n\t\t\t\taddEventListener(window, eventName, handleEvent);\n\t\t\t},\n\t\t\tremove: function (eventName) {\n\t\t\t\tvar handleEvent = eventHandlersByName[eventName];\n\t\t\t\tdelete eventHandlersByName[eventName];\n\n\t\t\t\tremoveEventListener(window, eventName, handleEvent);\n\t\t\t}\n\t\t};\n\n\t\tif (options.eventNames && Array.prototype.map) {\n\t\t\toptions.eventName = options.eventNames[0];\n\t\t\toptions.eventNames.map(listener[options.method]);\n\t\t} else {\n\t\t\tlistener[options.method](options.eventName);\n\t\t}\n\n\t\tlog(capitalizeFirstLetter(options.method) + ' event listener: ' + options.eventType);\n\t}\n\n\tfunction manageEventListeners(method) {\n\t\tmanageTriggerEvent({ method: method, eventType: 'Animation Start', eventNames: ['animationstart', 'webkitAnimationStart'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Animation Iteration', eventNames: ['animationiteration', 'webkitAnimationIteration'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Animation End', eventNames: ['animationend', 'webkitAnimationEnd'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Input', eventName: 'input' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Mouse Up', eventName: 'mouseup' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Mouse Down', eventName: 'mousedown' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Orientation Change', eventName: 'orientationchange' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Print', eventName: ['afterprint', 'beforeprint'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Ready State Change', eventName: 'readystatechange' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Touch Start', eventName: 'touchstart' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Touch End', eventName: 'touchend' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Touch Cancel', eventName: 'touchcancel' });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Transition Start', eventNames: ['transitionstart', 'webkitTransitionStart', 'MSTransitionStart', 'oTransitionStart', 'otransitionstart'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Transition Iteration', eventNames: ['transitioniteration', 'webkitTransitionIteration', 'MSTransitionIteration', 'oTransitionIteration', 'otransitioniteration'] });\n\t\tmanageTriggerEvent({ method: method, eventType: 'Transition End', eventNames: ['transitionend', 'webkitTransitionEnd', 'MSTransitionEnd', 'oTransitionEnd', 'otransitionend'] });\n\t\t//removed condition to check 'child' === resizeFrom to fix on tab change before iframe loads.\n\t\tmanageTriggerEvent({ method: method, eventType: 'IFrame Resized', eventName: 'resize' });\n\t}\n\n\tfunction checkCalcMode(calcMode, calcModeDefault, modes, type) {\n\t\tif (calcModeDefault !== calcMode) {\n\t\t\tif (!(calcMode in modes)) {\n\t\t\t\twarn(calcMode + ' is not a valid option for ' + type + 'CalculationMethod.');\n\t\t\t\tcalcMode = calcModeDefault;\n\t\t\t}\n\t\t\tlog(type + ' calculation method set to \"' + calcMode + '\"');\n\t\t}\n\n\t\treturn calcMode;\n\t}\n\n\tfunction checkHeightMode() {\n\t\theightCalcMode = checkCalcMode(heightCalcMode, heightCalcModeDefault, getHeight, 'height');\n\t}\n\n\tfunction checkWidthMode() {\n\t\twidthCalcMode = checkCalcMode(widthCalcMode, widthCalcModeDefault, getWidth, 'width');\n\t}\n\n\tfunction startEventListeners() {\n\t\tif (true === autoResize) {\n\t\t\tmanageEventListeners('add');\n\t\t\tsetupMutationObserver();\n\t\t}\n\t\telse {\n\t\t\tlog('Auto Resize disabled');\n\t\t}\n\t}\n\n\tfunction stopMsgsToParent() {\n\t\tlog('Disable outgoing messages');\n\t\tsendPermit = false;\n\t}\n\n\tfunction removeMsgListener() {\n\t\tlog('Remove event listener: Message');\n\t\tremoveEventListener(window, 'message', receiver);\n\t}\n\n\tfunction disconnectMutationObserver() {\n\t\tif (null !== bodyObserver) {\n\t\t\t/* istanbul ignore next */ // Not testable in PhantonJS\n\t\t\tbodyObserver.disconnect();\n\t\t}\n\t}\n\n\tfunction stopEventListeners() {\n\t\tmanageEventListeners('remove');\n\t\tdisconnectMutationObserver();\n\t\tclearInterval(intervalTimer);\n\t}\n\n\tfunction teardown() {\n\t\tstopMsgsToParent();\n\t\tremoveMsgListener();\n\t\tif (true === autoResize) stopEventListeners();\n\t}\n\n\tfunction injectClearFixIntoBodyElement() {\n\t\tvar clearFix = document.createElement('div');\n\t\tclearFix.style.clear = 'both';\n\t\tclearFix.style.display = 'block'; //Guard against this having been globally redefined in CSS.\n\t\tdocument.body.appendChild(clearFix);\n\t}\n\n\tfunction setupInPageLinks() {\n\n\t\tfunction getPagePosition() {\n\t\t\treturn {\n\t\t\t\tx: (window.pageXOffset !== undefined) ? window.pageXOffset : document.documentElement.scrollLeft,\n\t\t\t\ty: (window.pageYOffset !== undefined) ? window.pageYOffset : document.documentElement.scrollTop\n\t\t\t};\n\t\t}\n\n\t\tfunction getElementPosition(el) {\n\t\t\tvar\n\t\t\t\telPosition = el.getBoundingClientRect(),\n\t\t\t\tpagePosition = getPagePosition();\n\n\t\t\treturn {\n\t\t\t\tx: parseInt(elPosition.left, 10) + parseInt(pagePosition.x, 10),\n\t\t\t\ty: parseInt(elPosition.top, 10) + parseInt(pagePosition.y, 10)\n\t\t\t};\n\t\t}\n\n\t\tfunction findTarget(location) {\n\t\t\tfunction jumpToTarget(target) {\n\t\t\t\tvar jumpPosition = getElementPosition(target);\n\n\t\t\t\tlog('Moving to in page link (#' + hash + ') at x: ' + jumpPosition.x + ' y: ' + jumpPosition.y);\n\t\t\t\tsendMsg(jumpPosition.y, jumpPosition.x, 'scrollToOffset'); // X&Y reversed at sendMsg uses height/width\n\t\t\t}\n\n\t\t\tvar\n\t\t\t\thash = location.split('#')[1] || location, //Remove # if present\n\t\t\t\thashData = decodeURIComponent(hash),\n\t\t\t\ttarget = document.getElementById(hashData) || document.getElementsByName(hashData)[0];\n\n\t\t\tif (undefined !== target) {\n\t\t\t\tjumpToTarget(target);\n\t\t\t} else {\n\t\t\t\tlog('In page link (#' + hash + ') not found in iFrame, so sending to parent');\n\t\t\t\tsendMsg(0, 0, 'inPageLink', '#' + hash);\n\t\t\t}\n\t\t}\n\n\t\tfunction checkLocationHash() {\n\t\t\tif ('' !== location.hash && '#' !== location.hash) {\n\t\t\t\tfindTarget(location.href);\n\t\t\t}\n\t\t}\n\n\t\tfunction bindAnchors() {\n\t\t\tfunction setupLink(el) {\n\t\t\t\tfunction linkClicked(e) {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t/*jshint validthis:true */\n\t\t\t\t\tfindTarget(this.getAttribute('href'));\n\t\t\t\t}\n\n\t\t\t\tif ('#' !== el.getAttribute('href')) {\n\t\t\t\t\taddEventListener(el, 'click', linkClicked);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tArray.prototype.forEach.call(document.querySelectorAll('a[href^=\"#\"]'), setupLink);\n\t\t}\n\n\t\tfunction bindLocationHash() {\n\t\t\taddEventListener(window, 'hashchange', checkLocationHash);\n\t\t}\n\n\t\tfunction initCheck() { //check if page loaded with location hash after init resize\n\t\t\tsetTimeout(checkLocationHash, eventCancelTimer);\n\t\t}\n\n\t\tfunction enableInPageLinks() {\n\t\t\t/* istanbul ignore else */ // Not testable in phantonJS\n\t\t\tif (Array.prototype.forEach && document.querySelectorAll) {\n\t\t\t\tlog('Setting up location.hash handlers');\n\t\t\t\tbindAnchors();\n\t\t\t\tbindLocationHash();\n\t\t\t\tinitCheck();\n\t\t\t} else {\n\t\t\t\twarn('In page linking not fully supported in this browser! (See README.md for IE8 workaround)');\n\t\t\t}\n\t\t}\n\n\t\tif (inPageLinks.enable) {\n\t\t\tenableInPageLinks();\n\t\t} else {\n\t\t\tlog('In page linking not enabled');\n\t\t}\n\n\t\treturn {\n\t\t\tfindTarget: findTarget\n\t\t};\n\t}\n\n\tfunction setupPublicMethods() {\n\t\tlog('Enable public methods');\n\n\t\twin.parentIFrame = {\n\n\t\t\tautoResize: function autoResizeF(resize) {\n\t\t\t\tif (true === resize && false === autoResize) {\n\t\t\t\t\tautoResize = true;\n\t\t\t\t\tstartEventListeners();\n\t\t\t\t\t//sendSize('autoResize','Auto Resize enabled');\n\t\t\t\t} else if (false === resize && true === autoResize) {\n\t\t\t\t\tautoResize = false;\n\t\t\t\t\tstopEventListeners();\n\t\t\t\t}\n\n\t\t\t\treturn autoResize;\n\t\t\t},\n\n\t\t\tclose: function closeF() {\n\t\t\t\tsendMsg(0, 0, 'close');\n\t\t\t\tteardown();\n\t\t\t},\n\n\t\t\tgetId: function getIdF() {\n\t\t\t\treturn myID;\n\t\t\t},\n\n\t\t\tgetPageInfo: function getPageInfoF(callback) {\n\t\t\t\tif ('function' === typeof callback) {\n\t\t\t\t\tpageInfoCallback = callback;\n\t\t\t\t\tsendMsg(0, 0, 'pageInfo');\n\t\t\t\t} else {\n\t\t\t\t\tpageInfoCallback = function () { };\n\t\t\t\t\tsendMsg(0, 0, 'pageInfoStop');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmoveToAnchor: function moveToAnchorF(hash) {\n\t\t\t\tinPageLinks.findTarget(hash);\n\t\t\t},\n\n\t\t\treset: function resetF() {\n\t\t\t\tresetIFrame('parentIFrame.reset');\n\t\t\t},\n\n\t\t\tscrollTo: function scrollToF(x, y) {\n\t\t\t\tsendMsg(y, x, 'scrollTo'); // X&Y reversed at sendMsg uses height/width\n\t\t\t},\n\n\t\t\tscrollToOffset: function scrollToF(x, y) {\n\t\t\t\tsendMsg(y, x, 'scrollToOffset'); // X&Y reversed at sendMsg uses height/width\n\t\t\t},\n\n\t\t\tsendMessage: function sendMessageF(msg, targetOrigin) {\n\t\t\t\tsendMsg(0, 0, 'message', JSON.stringify(msg), targetOrigin);\n\t\t\t},\n\n\t\t\tsetHeightCalculationMethod: function setHeightCalculationMethodF(heightCalculationMethod) {\n\t\t\t\theightCalcMode = heightCalculationMethod;\n\t\t\t\tcheckHeightMode();\n\t\t\t},\n\n\t\t\tsetWidthCalculationMethod: function setWidthCalculationMethodF(widthCalculationMethod) {\n\t\t\t\twidthCalcMode = widthCalculationMethod;\n\t\t\t\tcheckWidthMode();\n\t\t\t},\n\n\t\t\tsetTargetOrigin: function setTargetOriginF(targetOrigin) {\n\t\t\t\tlog('Set targetOrigin: ' + targetOrigin);\n\t\t\t\ttargetOriginDefault = targetOrigin;\n\t\t\t},\n\n\t\t\tsize: function sizeF(customHeight, customWidth) {\n\t\t\t\tvar valString = '' + (customHeight ? customHeight : '') + (customWidth ? ',' + customWidth : '');\n\t\t\t\t//lockTrigger();\n\t\t\t\tsendSize('size', 'parentIFrame.size(' + valString + ')', customHeight, customWidth);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction initInterval() {\n\t\tif (0 !== interval) {\n\t\t\tlog('setInterval: ' + interval + 'ms');\n\t\t\tintervalTimer = setInterval(function () {\n\t\t\t\tsendSize('interval', 'setInterval: ' + interval);\n\t\t\t}, Math.abs(interval));\n\t\t}\n\t}\n\n\t/* istanbul ignore next */  //Not testable in PhantomJS\n\tfunction setupBodyMutationObserver() {\n\t\tfunction addImageLoadListners(mutation) {\n\t\t\tfunction addImageLoadListener(element) {\n\t\t\t\tif (false === element.complete) {\n\t\t\t\t\tlog('Attach listeners to ' + element.src);\n\t\t\t\t\telement.addEventListener('load', imageLoaded, false);\n\t\t\t\t\telement.addEventListener('error', imageError, false);\n\t\t\t\t\telements.push(element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mutation.type === 'attributes' && mutation.attributeName === 'src') {\n\t\t\t\taddImageLoadListener(mutation.target);\n\t\t\t} else if (mutation.type === 'childList') {\n\t\t\t\tArray.prototype.forEach.call(\n\t\t\t\t\tmutation.target.querySelectorAll('img'),\n\t\t\t\t\taddImageLoadListener\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tfunction removeFromArray(element) {\n\t\t\telements.splice(elements.indexOf(element), 1);\n\t\t}\n\n\t\tfunction removeImageLoadListener(element) {\n\t\t\tlog('Remove listeners from ' + element.src);\n\t\t\telement.removeEventListener('load', imageLoaded, false);\n\t\t\telement.removeEventListener('error', imageError, false);\n\t\t\tremoveFromArray(element);\n\t\t}\n\n\t\tfunction imageEventTriggered(event, type, typeDesc) {\n\t\t\tremoveImageLoadListener(event.target);\n\t\t\tsendSize(type, typeDesc + ': ' + event.target.src, undefined, undefined);\n\t\t}\n\n\t\tfunction imageLoaded(event) {\n\t\t\timageEventTriggered(event, 'imageLoad', 'Image loaded');\n\t\t}\n\n\t\tfunction imageError(event) {\n\t\t\timageEventTriggered(event, 'imageLoadFailed', 'Image load failed');\n\t\t}\n\n\t\tfunction mutationObserved(mutations) {\n\t\t\tsendSize('mutationObserver', 'mutationObserver: ' + mutations[0].target + ' ' + mutations[0].type);\n\n\t\t\t//Deal with WebKit asyncing image loading when tags are injected into the page\n\t\t\tmutations.forEach(addImageLoadListners);\n\t\t}\n\n\t\tfunction createMutationObserver() {\n\t\t\tvar\n\t\t\t\ttarget = document.querySelector('body'),\n\n\t\t\t\tconfig = {\n\t\t\t\t\tattributes: true,\n\t\t\t\t\tattributeOldValue: false,\n\t\t\t\t\tcharacterData: true,\n\t\t\t\t\tcharacterDataOldValue: false,\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true\n\t\t\t\t};\n\n\t\t\tobserver = new MutationObserver(mutationObserved);\n\n\t\t\tlog('Create body MutationObserver');\n\t\t\tobserver.observe(target, config);\n\n\t\t\treturn observer;\n\t\t}\n\n\t\tvar\n\t\t\telements = [],\n\t\t\tMutationObserver = window.MutationObserver || window.WebKitMutationObserver,\n\t\t\tobserver = createMutationObserver();\n\n\t\treturn {\n\t\t\tdisconnect: function () {\n\t\t\t\tif ('disconnect' in observer) {\n\t\t\t\t\tlog('Disconnect body MutationObserver');\n\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\telements.forEach(removeImageLoadListener);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction setupMutationObserver() {\n\t\tvar forceIntervalTimer = 0 > interval;\n\n\t\t/* istanbul ignore if */ // Not testable in PhantomJS\n\t\tif (window.MutationObserver || window.WebKitMutationObserver) {\n\t\t\tif (forceIntervalTimer) {\n\t\t\t\tinitInterval();\n\t\t\t} else {\n\t\t\t\tbodyObserver = setupBodyMutationObserver();\n\t\t\t}\n\t\t} else {\n\t\t\tlog('MutationObserver not supported in this browser!');\n\t\t\tinitInterval();\n\t\t}\n\t}\n\n\n\t// document.documentElement.offsetHeight is not reliable, so\n\t// we have to jump through hoops to get a better value.\n\tfunction getComputedStyle(prop, el) {\n\t\t/* istanbul ignore next */  //Not testable in PhantomJS\n\t\tfunction convertUnitsToPxForIE8(value) {\n\t\t\tvar PIXEL = /^\\d+(px)?$/i;\n\n\t\t\tif (PIXEL.test(value)) {\n\t\t\t\treturn parseInt(value, base);\n\t\t\t}\n\n\t\t\tvar\n\t\t\t\tstyle = el.style.left,\n\t\t\t\truntimeStyle = el.runtimeStyle.left;\n\n\t\t\tel.runtimeStyle.left = el.currentStyle.left;\n\t\t\tel.style.left = value || 0;\n\t\t\tvalue = el.style.pixelLeft;\n\t\t\tel.style.left = style;\n\t\t\tel.runtimeStyle.left = runtimeStyle;\n\n\t\t\treturn value;\n\t\t}\n\n\t\tvar retVal = 0;\n\t\tel = el || document.body;\n\n\t\t/* istanbul ignore else */ // Not testable in phantonJS\n\t\tif (('defaultView' in document) && ('getComputedStyle' in document.defaultView)) {\n\t\t\tretVal = document.defaultView.getComputedStyle(el, null);\n\t\t\tretVal = (null !== retVal) ? retVal[prop] : 0;\n\t\t} else {//IE8\n\t\t\tretVal = convertUnitsToPxForIE8(el.currentStyle[prop]);\n\t\t}\n\n\t\treturn parseInt(retVal, base);\n\t}\n\n\tfunction chkEventThottle(timer) {\n\t\tif (timer > throttledTimer / 2) {\n\t\t\tthrottledTimer = 2 * timer;\n\t\t\tlog('Event throttle increased to ' + throttledTimer + 'ms');\n\t\t}\n\t}\n\n\t//Idea from https://github.com/guardian/iframe-messenger\n\tfunction getMaxElement(side, elements, useMargin) {\n\t\tuseMargin = (typeof useMargin === 'undefined' ? true : useMargin);\n\t\tvar\n\t\t\telementsLength = elements.length,\n\t\t\telVal = 0,\n\t\t\tmaxVal = 0,\n\t\t\tSide = capitalizeFirstLetter(side),\n\t\t\ttimer = getNow();\n\n\t\tfor (var i = 0; i < elementsLength; i++) {\n\t\t\tvar marginHeight = getComputedStyle('margin' + Side, elements[i]);\n\t\t\telVal = elements[i].getBoundingClientRect()[side] + (useMargin ? marginHeight : 0);\n\t\t\tif (elVal > maxVal) {\n\t\t\t\tmaxVal = elVal;\n\t\t\t}\n\t\t}\n\t\ttimer = getNow() - timer;\n\n\t\tlog('Parsed ' + elementsLength + ' HTML elements');\n\t\tlog('Element position calculated in ' + timer + 'ms');\n\n\t\tchkEventThottle(timer);\n\n\t\treturn maxVal;\n\t}\n\n\tfunction getAllMeasurements(dimention) {\n\t\treturn [\n\t\t\tdimention.bodyOffset(),\n\t\t\tdimention.bodyScroll(),\n\t\t\tdimention.documentElementOffset(),\n\t\t\tdimention.documentElementScroll()\n\t\t];\n\t}\n\n\tfunction getTaggedElements(side, tag) {\n\t\tfunction noTaggedElementsFound() {\n\t\t\twarn('No tagged elements (' + tag + ') found on page');\n\t\t\treturn document.querySelectorAll('body *');\n\t\t}\n\n\t\tvar elements = document.querySelectorAll('[' + tag + ']');\n\n\t\tif (0 === elements.length) noTaggedElementsFound();\n\n\t\treturn getMaxElement(side, elements);\n\t}\n\n\tfunction getAllElements() {\n\t\treturn document.querySelectorAll('body *');\n\t}\n\n\t// To be moved to config file in v106\n    var ignoreSelector = '.data-iframe-ignore,.data-iframe-ignore-children *';\n\n\t// To be moved to config file in v106\n\tfunction getAllElementsIgnore() {\n        var elements = document.querySelectorAll('body *');\n        var ignored = document.querySelectorAll(ignoreSelector);\n        return Array.from(elements).filter(function(x){return !Array.from(ignored).includes(x)});\n\t}\n\n\tvar\n\t\tgetHeight = {\n\t\t\tbodyOffset: function getBodyOffsetHeight() {\n\t\t\t\treturn document.body.offsetHeight + getComputedStyle('marginTop') + getComputedStyle('marginBottom');\n\t\t\t},\n\n\t\t\toffset: function () {\n\t\t\t\treturn getHeight.bodyOffset(); //Backwards compatability\n\t\t\t},\n\n\t\t\tbodyScroll: function getBodyScrollHeight() {\n\t\t\t\treturn document.body.scrollHeight;\n\t\t\t},\n\n\t\t\tcustom: function getCustomWidth() {\n\t\t\t\treturn customCalcMethods.height();\n\t\t\t},\n\n\t\t\tdocumentElementOffset: function getDEOffsetHeight() {\n\t\t\t\treturn document.documentElement.offsetHeight;\n\t\t\t},\n\n\t\t\tdocumentElementScroll: function getDEScrollHeight() {\n\t\t\t\treturn document.documentElement.scrollHeight;\n\t\t\t},\n\n\t\t\tmax: function getMaxHeight() {\n\t\t\t\treturn Math.max.apply(null, getAllMeasurements(getHeight));\n\t\t\t},\n\n\t\t\tmin: function getMinHeight() {\n\t\t\t\treturn Math.min.apply(null, getAllMeasurements(getHeight));\n\t\t\t},\n\n\t\t\tgrow: function growHeight() {\n\t\t\t\treturn getHeight.max(); //Run max without the forced downsizing\n\t\t\t},\n\n\t\t\tlowestElement: function getBestHeight() {\n\t\t\t\treturn Math.max(getHeight.bodyOffset(), getMaxElement('bottom', getAllElementsIgnore()));\n\t\t\t},\n\n\t\t\ttaggedElement: function getTaggedElementsHeight() {\n\t\t\t\treturn getTaggedElements('bottom', 'data-iframe-height');\n\t\t\t},\n\n\t\t\tlowestElementNoMargin: function getBestHeight() {\n\t\t\t\treturn Math.max(getHeight.bodyOffset(), getMaxElement('bottom', getAllElementsIgnore(), false));\n\t\t\t},\n\t\t},\n\n\t\tgetWidth = {\n\t\t\tbodyScroll: function getBodyScrollWidth() {\n\t\t\t\treturn document.body.scrollWidth;\n\t\t\t},\n\n\t\t\tbodyOffset: function getBodyOffsetWidth() {\n\t\t\t\treturn document.body.offsetWidth;\n\t\t\t},\n\n\t\t\tcustom: function getCustomWidth() {\n\t\t\t\treturn customCalcMethods.width();\n\t\t\t},\n\n\t\t\tdocumentElementScroll: function getDEScrollWidth() {\n\t\t\t\treturn document.documentElement.scrollWidth;\n\t\t\t},\n\n\t\t\tdocumentElementOffset: function getDEOffsetWidth() {\n\t\t\t\treturn document.documentElement.offsetWidth;\n\t\t\t},\n\n\t\t\tscroll: function getMaxWidth() {\n\t\t\t\treturn Math.max(getWidth.bodyScroll(), getWidth.documentElementScroll());\n\t\t\t},\n\n\t\t\tmax: function getMaxWidth() {\n\t\t\t\treturn Math.max.apply(null, getAllMeasurements(getWidth));\n\t\t\t},\n\n\t\t\tmin: function getMinWidth() {\n\t\t\t\treturn Math.min.apply(null, getAllMeasurements(getWidth));\n\t\t\t},\n\n\t\t\trightMostElement: function rightMostElement() {\n\t\t\t\treturn getMaxElement('right', getAllElements());\n\t\t\t},\n\n\t\t\ttaggedElement: function getTaggedElementsWidth() {\n\t\t\t\treturn getTaggedElements('right', 'data-iframe-width');\n\t\t\t}\n\t\t};\n\n\n\tfunction sizeIFrame(triggerEvent, triggerEventDesc, customHeight, customWidth) {\n\n\t\tfunction resizeIFrame() {\n\t\t\theight = currentHeight;\n\t\t\twidth = currentWidth;\n\t\t\tif (height > 50) {\n\t\t\t\tsendMsg(height, width, triggerEvent);\n\t\t\t}\n\t\t}\n\n\t\tfunction isSizeChangeDetected() {\n\t\t\tfunction checkTolarance(a, b) {\n\t\t\t\tvar retVal = Math.abs(a - b) <= tolerance;\n\t\t\t\treturn !retVal;\n\t\t\t}\n\n\t\t\tcurrentHeight = (undefined !== customHeight) ? customHeight : getHeight[heightCalcMode]();\n\t\t\tcurrentWidth = (undefined !== customWidth) ? customWidth : getWidth[widthCalcMode]();\n\n\t\t\treturn checkTolarance(height, currentHeight) || (calculateWidth && checkTolarance(width, currentWidth));\n\t\t}\n\n\t\tfunction isForceResizableEvent() {\n\t\t\treturn !(triggerEvent in { 'init': 1, 'interval': 1, 'size': 1 });\n\t\t}\n\n\t\tfunction isForceResizableCalcMode() {\n\t\t\treturn (heightCalcMode in resetRequiredMethods) || (calculateWidth && widthCalcMode in resetRequiredMethods);\n\t\t}\n\n\t\tfunction logIgnored() {\n\t\t\tlog('No change in size detected');\n\t\t}\n\n\t\tfunction checkDownSizing() {\n\t\t\tif (isForceResizableEvent() && isForceResizableCalcMode()) {\n\t\t\t\tresetIFrame(triggerEventDesc);\n\t\t\t} else if (!(triggerEvent in { 'interval': 1 })) {\n\t\t\t\tlogIgnored();\n\t\t\t}\n\t\t}\n\n\t\tvar currentHeight, currentWidth;\n\n\t\tif (isSizeChangeDetected() || 'init' === triggerEvent) {\n\t\t\tlockTrigger();\n\t\t\tresizeIFrame();\n\t\t} else {\n\t\t\tcheckDownSizing();\n\t\t}\n\t}\n\n\tvar sizeIFrameThrottled = throttle(sizeIFrame);\n\n\tfunction sendSize(triggerEvent, triggerEventDesc, customHeight, customWidth) {\n\t\tfunction recordTrigger() {\n\t\t\tif (!(triggerEvent in { 'reset': 1, 'resetPage': 1, 'init': 1 })) {\n\t\t\t\tlog('Trigger event: ' + triggerEventDesc);\n\t\t\t}\n\t\t}\n\n\t\tfunction isDoubleFiredEvent() {\n\t\t\treturn triggerLocked && (triggerEvent in doubleEventList);\n\t\t}\n\n\t\tif (!isDoubleFiredEvent()) {\n\t\t\trecordTrigger();\n\t\t\tsizeIFrameThrottled(triggerEvent, triggerEventDesc, customHeight, customWidth);\n\t\t} else {\n\t\t\tlog('Trigger event cancelled: ' + triggerEvent);\n\t\t}\n\t}\n\n\tfunction lockTrigger() {\n\t\tif (!triggerLocked) {\n\t\t\ttriggerLocked = true;\n\t\t\tlog('Trigger event lock on');\n\t\t}\n\t\tclearTimeout(triggerLockedTimer);\n\t\ttriggerLockedTimer = setTimeout(function () {\n\t\t\ttriggerLocked = false;\n\t\t\tlog('Trigger event lock off');\n\t\t\tlog('--');\n\t\t}, eventCancelTimer);\n\t}\n\n\tfunction triggerReset(triggerEvent) {\n\t\theight = getHeight[heightCalcMode]();\n\t\twidth = getWidth[widthCalcMode]();\n\n\t\tif (height > 50) {\n\t\t\tsendMsg(height, width, triggerEvent);\n\t\t}\n\t}\n\n\tfunction resetIFrame(triggerEventDesc) {\n\t\tvar hcm = heightCalcMode;\n\t\theightCalcMode = heightCalcModeDefault;\n\n\t\tlog('Reset trigger event: ' + triggerEventDesc);\n\t\tlockTrigger();\n\t\ttriggerReset('reset');\n\n\t\theightCalcMode = hcm;\n\t}\n\n\tfunction sendMsg(height, width, triggerEvent, msg, targetOrigin) {\n\t\tfunction setTargetOrigin() {\n\t\t\tif (undefined === targetOrigin) {\n\t\t\t\ttargetOrigin = targetOriginDefault;\n\t\t\t} else {\n\t\t\t\tlog('Message targetOrigin: ' + targetOrigin);\n\t\t\t}\n\t\t}\n\n\t\tfunction sendToParent() {\n\t\t\tvar\n\t\t\t\tsize = height + ':' + width,\n\t\t\t\tmessage = myID + ':' + size + ':' + triggerEvent + (undefined !== msg ? ':' + msg : '');\n\n\t\t\tlog('Sending message to host page (' + message + ')');\n\t\t\ttarget.postMessage(msgID + message, targetOrigin);\n\t\t}\n\n\t\tif (true === sendPermit) {\n\t\t\tsetTargetOrigin();\n\t\t\tsendToParent();\n\t\t}\n\t}\n\n\tfunction receiver(event) {\n\t\tvar processRequestFromParent = {\n\t\t\tinit: function initFromParent() {\n\t\t\t\tfunction fireInit() {\n\t\t\t\t\tinitMsg = event.data;\n\t\t\t\t\ttarget = event.source;\n\n\t\t\t\t\tinit();\n\t\t\t\t\tfirstRun = false;\n\t\t\t\t\tsetTimeout(function () { initLock = false; }, eventCancelTimer);\n\t\t\t\t}\n\n\t\t\t\tif (document.body) {\n\t\t\t\t\tfireInit();\n\t\t\t\t} else {\n\t\t\t\t\tlog('Waiting for page ready');\n\t\t\t\t\taddEventListener(window, 'readystatechange', processRequestFromParent.initFromParent);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\treset: function resetFromParent() {\n\t\t\t\tif (!initLock) {\n\t\t\t\t\tlog('Page size reset by host page');\n\t\t\t\t\ttriggerReset('resetPage');\n\t\t\t\t} else {\n\t\t\t\t\tlog('Page reset ignored by init');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tresize: function resizeFromParent() {\n\t\t\t\tsendSize('resizeParent', 'Parent window requested size check');\n\t\t\t},\n\n\t\t\tmoveToAnchor: function moveToAnchorF() {\n\t\t\t\tinPageLinks.findTarget(getData());\n\t\t\t},\n\t\t\tinPageLink: function inPageLinkF() { this.moveToAnchor(); }, //Backward compatability\n\n\t\t\tpageInfo: function pageInfoFromParent() {\n\t\t\t\tvar msgBody = getData();\n\t\t\t\tlog('PageInfoFromParent called from parent: ' + msgBody);\n\t\t\t\tpageInfoCallback(JSON.parse(msgBody));\n\t\t\t\tlog(' --');\n\t\t\t},\n\n\t\t\tmessage: function messageFromParent() {\n\t\t\t\tvar msgBody = getData();\n\n\t\t\t\tlog('MessageCallback called from parent: ' + msgBody);\n\t\t\t\tmessageCallback(JSON.parse(msgBody));\n\t\t\t\tlog(' --');\n\t\t\t}\n\t\t};\n\n\t\tfunction isMessageForUs() {\n\t\t\treturn msgID === ('' + event.data).substr(0, msgIdLen); //''+ Protects against non-string messages\n\t\t}\n\n\t\tfunction getMessageType() {\n\t\t\treturn event.data.split(']')[1].split(':')[0];\n\t\t}\n\n\t\tfunction getData() {\n\t\t\treturn event.data.substr(event.data.indexOf(':') + 1);\n\t\t}\n\n\t\tfunction isMiddleTier() {\n\t\t\treturn !(typeof module !== 'undefined' && module.exports) && ('iFrameResize' in window);\n\t\t}\n\n\t\tfunction isInitMsg() {\n\t\t\t//Test if this message is from a child below us. This is an ugly test, however, updating\n\t\t\t//the message format would break backwards compatibity.\n\t\t\treturn event.data.split(':')[2] in { 'true': 1, 'false': 1 };\n\t\t}\n\n\t\tfunction callFromParent() {\n\t\t\tvar messageType = getMessageType();\n\n\t\t\tif (messageType in processRequestFromParent) {\n\t\t\t\tprocessRequestFromParent[messageType]();\n\t\t\t} else if (!isMiddleTier() && !isInitMsg()) {\n\t\t\t\twarn('Unexpected message (' + event.data + ')');\n\t\t\t}\n\t\t}\n\n\t\tfunction processMessage() {\n\t\t\tif (false === firstRun) {\n\t\t\t\tcallFromParent();\n\t\t\t} else if (isInitMsg()) {\n\t\t\t\tprocessRequestFromParent.init();\n\t\t\t} else {\n\t\t\t\tlog('Ignored message of type \"' + getMessageType() + '\". Received before initialization.');\n\t\t\t}\n\t\t}\n\n\t\tif (isMessageForUs()) {\n\t\t\tprocessMessage();\n\t\t}\n\t}\n\n\t//Normally the parent kicks things off when it detects the iFrame has loaded.\n\t//If this script is async-loaded, then tell parent page to retry init.\n\tfunction chkLateLoaded() {\n\t\tif ('loading' !== document.readyState) {\n\t\t\twindow.parent.postMessage('[iFrameResizerChild]Ready', '*');\n\t\t}\n\t}\n\n\taddEventListener(window, 'message', receiver);\n\tchkLateLoaded();\n\n\n\n})();"]}